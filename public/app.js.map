{"version":3,"sources":["app.js","event.js","gather.js","main.js","message.js","settings.js","snowMachine.js","sound.js","teamspeak.js","user.js","helper.js"],"names":[],"mappings":"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","file":"public/app.js","sourcesContent":["const React = require(\"react\");\nconst ReactDOM = require(\"react-dom\");\nconst App = require(\"javascripts/components/main\");\n\nmodule.exports = function (mount) { \n\tReactDOM.render(<App />, mount);\n};\n","const React = require(\"react\");\nconst Events = exports.Events = React.createClass({\n\tpropTypes: {\n\t\tevents: React.PropTypes.array.isRequired\n\t},\n\n\tgetTime(timeString) {\n\t\treturn (new Date(timeString)).toTimeString().match(/^[\\d:]*/)[0];\n\t},\n\n\trender() {\n\t\tlet events;\n\t\tif (this.props.events.length) {\n\t\t\tevents = this.props.events.map(event => {\n\t\t\t\treturn `${this.getTime(event.createdAt)} ${event.description}`;\n\t\t\t}).join(\"\\n\");\n\t\t\treturn (\n\t\t\t\t<pre className=\"events-panel\">\n\t\t\t\t\t{events}\n\t\t\t\t</pre>\n\t\t\t);\n\t\t} else {\n\t\t\treturn (\n\t\t\t\t<pre className=\"events-panel\">\n\t\t\t\t\tListening for new events...\n\t\t\t\t</pre>\n\t\t\t);\n\t\t}\n\t}\n});\n","import {AssumeUserIdButton} from \"javascripts/components/user\";\n\nconst React = require(\"react\");\nconst helper = require(\"javascripts/helper\");\nconst enslUrl = helper.enslUrl;\nconst rankVotes = helper.rankeVotes;\nconst hiveUrl = helper.hiveUrl;\n\nconst SelectPlayerButton = React.createClass({\n\tpropTypes: {\n\t\tsocket: React.PropTypes.object.isRequired,\n\t\tgatherer: React.PropTypes.object.isRequired\n\t},\n\n\tselectPlayer(e) {\n\t\te.preventDefault();\n\t\tthis.props.socket.emit(\"gather:select\", {\n\t\t\tplayer: parseInt(e.target.value, 10)\n\t\t});\n\t},\n\n\trender() {\n\t\tlet button;\n\t\tif (this.props.gatherer.leader) {\n\t\t\tbutton = <button \n\t\t\t\tclassName=\"btn btn-xs btn-default team-label\"\n\t\t\t\tdata-disabled=\"true\">Leader</button>;\n\t\t} else if (this.props.gatherer.team !== \"lobby\") {\n\t\t\tbutton = <button\n\t\t\t\tdata-disabled=\"true\"\n\t\t\t\tclassName=\"btn btn-xs btn-default team-label\"> \n\t\t\t\t\t{_.capitalize(this.props.gatherer.team)}\n\t\t\t\t</button>;\n\t\t} else {\n\t\t\tbutton = <button\n\t\t\t\tonClick={this.selectPlayer}\n\t\t\t\tvalue={this.props.gatherer.id}\n\t\t\t\tclassName=\"btn btn-xs btn-primary team-label\"> Select\n\t\t\t\t</button>;\n\t\t}\n\t\treturn button;\n\t}\n});\n\nconst GathererList = React.createClass({\n\tmemberList() {\n\t\tconst self = this;\n\t\treturn this.props.gather.gatherers\n\t\t\t.filter(gatherer => gatherer.team === self.props.team)\n\t\t\t.sort(gatherer => { return gatherer.leader ? 1 : -1 });\n\t},\n\n\trender() {\n\t\tconst extractGatherer = gatherer => {\n\t\t\tlet image;\n\t\t\tif (gatherer.leader) {\n\t\t\t\timage = <i className=\"fa fa-star add-right\"></i>;\n\t\t\t}\n\t\t\treturn (\n\t\t\t\t<tr key={gatherer.id}>\n\t\t\t\t\t<td className=\"col-md-12\">\n\t\t\t\t\t\t{image}{gatherer.user.username}\n\t\t\t\t\t\t<span className=\"pull-right\">\n\t\t\t\t\t\t\t<LifeformIcons gatherer={gatherer} />\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t);\n\t\t};\n\t\tconst members = this.memberList()\n\t\t\t.map(extractGatherer);\n\t\treturn (\n\t\t\t<table className=\"table\">\n\t\t\t\t<tbody>\n\t\t\t\t\t{members}\n\t\t\t\t</tbody>\n\t\t\t</table>\n\t\t);\n\t}\n});\n\nconst GatherTeams = React.createClass({\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"row add-top\">\n\t\t\t\t<div className=\"col-sm-6\">\n\t\t\t\t\t<div className=\"panel panel-primary panel-light-background\">\n\t\t\t\t\t\t<div className=\"panel-heading\">\n\t\t\t\t\t\t\tMarines\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<GathererList gather={this.props.gather} team=\"marine\" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"col-sm-6\">\n\t\t\t\t\t<div className=\"panel panel-primary panel-light-background\">\n\t\t\t\t\t\t<div className=\"panel-heading\">\n\t\t\t\t\t\t\tAliens\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<GathererList gather={this.props.gather} team=\"alien\" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n});\n\nconst ElectionProgressBar = React.createClass({\n\tcomponentDidMount() {\n\t\tconst self = this;\n\t\tthis.timer = setInterval(() => {\n\t\t\tself.forceUpdate();\n\t\t}, 900);\n\t},\n\n\tprogress() {\n\t\tconst interval = this.props.gather.election.interval;\n\t\tconst startTime = (new Date(this.props.gather.election.startTime)).getTime();\n\t\tconst msTranspired = Math.floor((new Date()).getTime() - startTime);\n\n\t\treturn {\n\t\t\tnum: msTranspired,\n\t\t\tden: interval,\n\t\t\tbarMessage: Math.floor((interval - msTranspired) / 1000) + \"s remaining\"\n\t\t}\n\t},\n\n\tcomponentWillUnmount() {\n\t\tclearInterval(this.timer);\n\t},\n\n\trender() {\n\t\treturn (<ProgressBar progress={this.progress()} />);\n\t}\n});\n\nconst ProgressBar = React.createClass({\n\trender() {\n\t\tconst progress = this.props.progress;\n\t\tconst style = {\n\t\t\twidth: Math.round((progress.num / progress.den * 100)) + \"%\"\n\t\t};\n\t\tconst barMessage = progress.barMessage || \"\";\n\t\treturn (\n\t\t\t<div className=\"progress\">\n\t\t\t\t<div className=\"progress-bar progress-bar-striped active\" \n\t\t\t\t\tdata-role=\"progressbar\" \n\t\t\t\t\tdata-aria-valuenow={progress.num} \n\t\t\t\t\tdata-aria-valuemin=\"0\" \n\t\t\t\t\tdata-aria-valuemax={progress.den} \n\t\t\t\t\tstyle={style}>{barMessage}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n});\n\nconst GatherProgress = React.createClass({\n\tstateDescription() {\n\t\tswitch(this.props.gather.state) {\n\t\t\tcase \"gathering\":\n\t\t\t\treturn \"Waiting for more gatherers.\";\n\t\t\tcase \"election\":\n\t\t\t\treturn \"Currently voting for team leaders.\";\n\t\t\tcase \"selection\":\n\t\t\t\treturn \"Waiting for leaders to pick teams.\";\n\t\t\tcase \"done\":\n\t\t\t\treturn \"Gather completed.\";\n\t\t\tdefault:\n\t\t\t\treturn \"Initialising gather.\";\n\t\t}\n\t},\n\n\tgatheringProgress() {\n\t\tconst num = this.props.gather.gatherers.length;\n\t\tconst den = 12;\n\t\tconst remaining = den - num;\n\t\tconst message = (remaining === 1) ? \n\t\t\t\"Waiting for last player\" : `Waiting for ${remaining} more players`;\n\t\treturn {\n\t\t\tnum: num,\n\t\t\tden: den,\n\t\t\tmessage: message\n\t\t};\n\t},\n\n\telectionProgress() {\n\t\tconst num = this.props.gather.gatherers.reduce((acc, gatherer) => {\n\t\t\tif (gatherer.leaderVote) acc++;\n\t\t\treturn acc;\n\t\t}, 0);\n\t\tconst den = 12;\n\t\treturn {\n\t\t\tnum: num,\n\t\t\tden: den,\n\t\t\tmessage: den - num + \" more votes required\"\n\t\t};\n\t},\n\n\tselectionProgress() {\n\t\tconst num = this.props.gather.gatherers.reduce((acc, gatherer) => {\n\t\t\tif (gatherer.team !== \"lobby\") acc++;\n\t\t\treturn acc;\n\t\t}, 0);\n\t\tconst den = 12;\n\n\t\treturn {\n\t\t\tnum: num,\n\t\t\tden: den,\n\t\t\tmessage: `${num} out of ${den} players assigned. Waiting \n\t\t\t\ton ${_.capitalize(this.props.gather.pickingTurn)}s to pick next...`\n\t\t};\n\t},\n\n\trender() {\n\t\tlet progress, progressBar;\n\t\tconst gatherState = this.props.gather.state;\n\t\tif (gatherState === 'gathering' && this.props.gather.gatherers.length) {\n\t\t\tprogress = this.gatheringProgress();\n\t\t\tprogressBar = (<ProgressBar progress={progress} />);\n\t\t} else if (gatherState === 'election') {\n\t\t\tprogress = this.electionProgress();\n\t\t\tprogressBar = (<ElectionProgressBar {...this.props} progress={progress} />);\n\t\t} else if (gatherState === 'selection') {\n\t\t\tprogress = this.selectionProgress();\n\t\t\tprogressBar = (<ProgressBar progress={progress} />);\n\t\t}\n\n\t\tif (!progress) return false;\n\n\t\treturn (\n\t\t\t<div className=\"no-bottom\">\n\t\t\t\t<p><strong>{this.stateDescription()}</strong> {progress.message}</p>\n\t\t\t\t{progressBar}\n\t\t\t</div>\n\t\t);\n\t}\n});\n\nconst JoinGatherButton = React.createClass({\n\tpropTypes: {\n\t\tthisGatherer: React.PropTypes.object,\n\t\tuser: React.PropTypes.object.isRequired,\n\t\tsocket: React.PropTypes.object.isRequired,\n\t\tgather: React.PropTypes.object.isRequired\n\t},\n\n\tcomponentDidMount() {\n\t\tconst self = this;\n\t\tthis.timer = setInterval(() => {\n\t\t\tself.forceUpdate();\n\t\t}, 30000);\n\t},\n\n\tcomponentWillUnmount() {\n\t\tclearInterval(this.timer);\n\t},\n\n\tjoinGather(e) {\n\t\te.preventDefault();\n\t\tthis.props.socket.emit(\"gather:join\");\n\t},\n\n\tleaveGather(e) {\n\t\te.preventDefault();\n\t\tthis.props.socket.emit(\"gather:leave\");\n\t},\n\n\tcooldownTime() {\n\t\tlet user = this.props.user;\n\t\tif (!user) return false;\n\t\tlet cooloffTime = this.props.gather.cooldown[user.id];\n\t\tif (!cooloffTime) return false;\n\t\tlet timeRemaining = new Date(cooloffTime) - new Date();\n\t\treturn timeRemaining > 0 ? timeRemaining : false;\n\t},\n\n\trender() {\n\t\tlet gather = this.props.gather;\n\t\tlet thisGatherer = this.props.thisGatherer;\n\t\tif (thisGatherer) {\n\t\t\treturn <button \n\t\t\t\t\t\t\tonClick={this.leaveGather} \n\t\t\t\t\t\t\tclassName=\"btn btn-danger\">Leave Gather</button>;\n\t\t} \n\t\tif (gather.state === 'gathering') {\n\t\t\tlet cooldownTime = this.cooldownTime();\n\t\t\tif (cooldownTime) {\n\t\t\t\treturn <CooloffButton timeRemaining={cooldownTime} />;\n\t\t\t} else {\n\t\t\t\treturn <button \n\t\t\t\t\t\tonClick={this.joinGather} \n\t\t\t\t\t\tclassName=\"btn btn-success\">Join Gather</button>;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n});\n\nconst CooloffButton = React.createClass({\n\tpropTypes: {\n\t\ttimeRemaining: React.PropTypes.number.isRequired\n\t},\n\n\ttimeRemaining() {\n\t\treturn `${Math.floor(this.props.timeRemaining / 60000) + 1} minutes remaining`;\n\t},\n\n\trender() {\n\t\treturn <button \n\t\t\tdisabled=\"true\"\n\t\t\tclassName=\"btn btn-success\">\n\t\t\t\tLeaver Cooloff ({this.timeRemaining()})\n\t\t</button>\n\t}\n})\n\nconst GatherActions = React.createClass({\n\tpropTypes: {\n\t\tsocket: React.PropTypes.object.isRequired,\n\t\tgather: React.PropTypes.object.isRequired,\n\t\tthisGatherer: React.PropTypes.object\n\t},\n\n\tvoteRegather(e) {\n\t\te.preventDefault(e);\n\t\tthis.props.socket.emit(\"gather:vote\", {\n\t\t\tregather: (e.target.value === \"true\")\n\t\t});\n\t},\n\n\tregatherVotes() {\n\t\tlet gather = this.props.gather;\n\t\tif (!gather) return 0;\n\t\treturn gather.gatherers.reduce((acc, gatherer) => {\n\t\t\tif (gatherer.regatherVote) acc++;\n\t\t\treturn acc;\n\t\t}, 0);\n\t},\n\n\trender() {\n\t\tlet regatherButton;\n\t\tconst user = this.props.user;\n\t\tconst gather = this.props.gather;\n\t\tconst socket = this.props.socket;\n\t\tconst thisGatherer = this.props.thisGatherer;\n\t\tif (thisGatherer) {\n\t\t\tlet regatherVotes = this.regatherVotes();\n\t\t\tif (thisGatherer.regatherVote) {\n\t\t\t\tregatherButton = <button value=\"false\" onClick={this.voteRegather} \n\t\t\t\t\t\tclassName=\"btn btn-danger\">\n\t\t\t\t\t\t\t{`Voted Regather (${regatherVotes}/8)`}\n\t\t\t\t\t</button>;\n\t\t\t} else {\n\t\t\t\tregatherButton = <button value=\"true\" onClick={this.voteRegather} \n\t\t\t\t\t\tclassName=\"btn btn-danger\">\n\t\t\t\t\t\t\t{`Vote Regather (${regatherVotes}/8)`}\n\t\t\t\t\t</button>;\n\t\t\t}\n\t\t}\n\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<div className=\"text-right\">\n\t\t\t\t\t<ul className=\"list-inline no-bottom\">\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t{regatherButton}\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<JoinGatherButton gather={gather} thisGatherer={thisGatherer}\n\t\t\t\t\t\t\t\tuser={user} socket={socket} />\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n});\n\nconst VoteButton = React.createClass({\n\tpropTypes: {\n\t\tsocket: React.PropTypes.object.isRequired,\n\t\tcandidate: React.PropTypes.object.isRequired,\n\t\tthisGatherer: React.PropTypes.object\n\t},\n\n\tcancelVote(e) {\n\t\tthis.props.socket.emit(\"gather:vote\", {\n\t\t\tleader: {\n\t\t\t\tcandidate: null\n\t\t\t}\n\t\t});\n\t},\n\n\tvote(e) {\n\t\te.preventDefault();\n\t\tthis.props.socket.emit(\"gather:vote\", {\n\t\t\tleader: {\n\t\t\t\tcandidate: parseInt(e.target.value, 10)\n\t\t\t}\n\t\t});\n\t},\n\n\tstopGatherMusic() {\n\t\tsoundController.stop();\n\t},\n\n\trender() {\n\t\tlet candidate = this.props.candidate;\n\t\tlet thisGatherer = this.props.thisGatherer;\n\t\tif (thisGatherer === null) {\n\t\t\treturn false;\n\t\t}\n\t\tif (thisGatherer.leaderVote === candidate.id) {\n\t\t\treturn (\n\t\t\t\t<button \n\t\t\t\t\tonClick={this.cancelVote} \n\t\t\t\t\tclassName=\"btn btn-xs btn-success vote-button\">Voted\n\t\t\t\t</button>\n\t\t\t);\n\t\t} else {\n\t\t\treturn (\n\t\t\t\t<button \n\t\t\t\t\tonClick={this.vote} \n\t\t\t\t\tclassName=\"btn btn-xs btn-primary vote-button\"\n\t\t\t\t\tvalue={candidate.id}>Vote\n\t\t\t\t</button>\n\t\t\t);\n\t\t}\n\t}\n});\n\nconst ServerVoting = React.createClass({\n\tpropTypes: {\n\t\tsocket: React.PropTypes.object.isRequired,\n\t\tgather: React.PropTypes.object.isRequired,\n\t\tthisGatherer: React.PropTypes.object,\n\t\tservers: React.PropTypes.array.isRequired,\n\t},\n\n\tvoteHandler(serverId) {\n\t\treturn e => {\n\t\t\te.preventDefault();\n\t\t\tthis.props.socket.emit(\"gather:vote\", {\n\t\t\t\tserver: {\n\t\t\t\t\tid: serverId\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\n\tvotesForServer(server) {\n\t\treturn this.props.gather.gatherers.reduce((acc, gatherer) => {\n\t\t\tif (gatherer.serverVote.some(voteId => voteId === server.id)) acc++;\n\t\t\treturn acc;\n\t\t}, 0);\n\t},\n\n\trender() {\n\t\tlet self = this;\n\t\tlet thisGatherer = self.props.thisGatherer;\n\t\tlet servers = self.props.servers.sort((a, b) => {\n\t\t\t\tconst aVotes = self.votesForServer(a);\n\t\t\t\tconst bVotes = self.votesForServer(b);\n\t\t\t\treturn bVotes - aVotes;\n\t\t\t}).map(server => {\n\t\t\tlet votes = self.votesForServer(server);\n\t\t\tlet style = thisGatherer.serverVote.some(voteId => voteId === server.id) ? \n\t\t\t\t\"list-group-item list-group-item-success\" : \"list-group-item\";\n\t\t\treturn (\n\t\t\t\t<a href=\"#\" \n\t\t\t\t\tclassName={style} \n\t\t\t\t\tonClick={self.voteHandler(server.id)} \n\t\t\t\t\tkey={server.id}>\n\t\t\t\t\t<span className=\"badge\">{votes}</span>\n\t\t\t\t\t{server.name || server.description}\n\t\t\t\t</a>\n\t\t\t);\n\t\t});\n\n\t\tlet votes = thisGatherer.serverVote.length;\n\n\t\treturn (\n\t\t\t<div className=\"panel panel-primary\">\n\t\t\t\t<div className=\"panel-heading\">\n\t\t\t\t\t{votes === 2 ? \"Server Votes\" : \n\t\t\t\t\t`Please Vote for a Server. ${2 - votes} votes remaining` }\n\t\t\t\t</div>\n\t\t\t\t<div className=\"list-group gather-voting\">\n\t\t\t\t\t{servers}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n})\n\nconst MapVoting = React.createClass({\n\tpropTypes: {\n\t\tsocket: React.PropTypes.object.isRequired,\n\t\tgather: React.PropTypes.object.isRequired,\n\t\tthisGatherer: React.PropTypes.object,\n\t\tmaps: React.PropTypes.array.isRequired,\n\t},\n\n\tvoteHandler(mapId) {\n\t\treturn e => {\n\t\t\te.preventDefault();\n\t\t\tthis.props.socket.emit(\"gather:vote\", {\n\t\t\t\tmap: {\n\t\t\t\t\tid: mapId\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\n\tvotesForMap(map) {\n\t\treturn this.props.gather.gatherers.reduce((acc, gatherer) => {\n\t\t\tif (gatherer.mapVote.some(voteId => voteId === map.id)) acc++;\n\t\t\treturn acc;\n\t\t}, 0);\n\t},\n\n\trender() {\n\t\tconst self = this;\n\t\tlet thisGatherer = self.props.thisGatherer\n\t\tlet maps = self.props.maps.sort((a, b) => {\n\t\t\t\t\tconst aVotes = self.votesForMap(a);\n\t\t\t\t\tconst bVotes = self.votesForMap(b);\n\t\t\t\t\treturn bVotes - aVotes;\n\t\t\t\t}).map(map => {\n\t\t\t\tlet votes = self.votesForMap(map);\n\t\t\t\tlet style = thisGatherer.mapVote.some(voteId => voteId === map.id) ? \n\t\t\t\t\t\"list-group-item list-group-item-success\" : \"list-group-item\";\n\t\t\t\treturn (\n\t\t\t\t\t<a href=\"#\" \n\t\t\t\t\t\tkey={map.id} \n\t\t\t\t\t\tonClick={self.voteHandler(map.id)}\n\t\t\t\t\t\tclassName={style}>\n\t\t\t\t\t\t\t<span className=\"badge\">{votes}</span>\n\t\t\t\t\t\t\t{map.name}\n\t\t\t\t\t</a>\n\t\t\t\t);\n\t\t\t});\n\n\t\tlet votes = thisGatherer.mapVote.length;\n\n\t\treturn (\n\t\t\t<div className=\"panel panel-primary\">\n\t\t\t\t<div className=\"panel-heading\">\n\t\t\t\t\t{votes === 2 ? \"Map Votes\" : \n\t\t\t\t\t\t`Please Vote for a Map. ${2 - votes} votes remaining` }\n\t\t\t\t</div>\n\t\t\t\t<div className=\"list-group gather-voting\">\n\t\t\t\t\t{maps}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n})\n\nconst Gather = exports.Gather = React.createClass({\n\tpropTypes: {\n\t\tthisGatherer: React.PropTypes.object,\n\t\tmaps: React.PropTypes.array.isRequired,\n\t\tservers: React.PropTypes.array.isRequired,\n\t\tsocket: React.PropTypes.object.isRequired,\n\t\tgather: React.PropTypes.object.isRequired\n\t},\n\n\trender() {\n\t\tconst socket = this.props.socket;\n\t\tconst gather = this.props.gather;\n\t\tconst thisGatherer = this.props.thisGatherer;\n\t\tconst servers = this.props.servers;\n\t\tconst maps = this.props.maps;\n\t\tconst user = this.props.user;\n\t\tif (gather === null) return <div></div>;\n\n\t\tlet voting;\n\t\tif (thisGatherer) {\n\t\t\tlet state = gather.state;\n\t\t\tif (state === 'gathering' || state === 'election') {\n\t\t\t\tvoting = (\n\t\t\t\t\t<div className=\"row add-top\">\n\t\t\t\t\t\t<div className=\"col-sm-6\">\n\t\t\t\t\t\t\t<MapVoting gather={gather} maps={maps} \n\t\t\t\t\t\t\t\tsocket={socket} thisGatherer={thisGatherer} />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"col-sm-6\">\n\t\t\t\t\t\t\t<ServerVoting gather={gather} servers={servers}\n\t\t\t\t\t\t\t\tsocket={socket} thisGatherer={thisGatherer} />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tvoting = <GatherVotingResults gather={gather} \n\t\t\t\t\tservers={servers} \n\t\t\t\t\tmaps={maps} />;\n\t\t\t}\n\t\t}\n\n\t\tlet gatherTeams;\n\t\tif (gather.state === 'selection') {\n\t\t\tgatherTeams = <GatherTeams gather={gather} />;\n\t\t}\n\n\t\tif (gather.gatherers.length > 0) {\n\t\t\treturn (\n\t\t\t\t<div>\n\t\t\t\t\t<div className=\"panel panel-primary add-bottom\">\n\t\t\t\t\t\t<div className=\"panel-heading\">Current Gather</div>\n\t\t\t\t\t\t<div className=\"panel-body\">\n\t\t\t\t\t\t\t<GatherProgress gather={gather} />\n\t\t\t\t\t\t\t<GatherActions gather={gather} user={user} thisGatherer={thisGatherer} \n\t\t\t\t\t\t\t\tsocket={socket} />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<Gatherers gather={gather} user={user} \n\t\t\t\t\t\tsoundController={this.props.soundController}\n\t\t\t\t\t\tthisGatherer={thisGatherer} socket={socket} />\n\t\t\t\t\t{gatherTeams}\n\t\t\t\t\t{voting}\n\t\t\t\t</div>\n\t\t\t);\n\t\t} else {\n\t\t\treturn (\n\t\t\t\t<div>\n\t\t\t\t\t<div className=\"panel panel-primary add-bottom\">\n\t\t\t\t\t\t<div className=\"panel-heading\">Current Gather</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<Gatherers gather={gather} user={user} thisGatherer={thisGatherer} \n\t\t\t\t\t\tsocket={socket} />\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\n\t}\n});\n\nconst LifeformIcons = exports.LifeformIcons = React.createClass({\n\tavailableLifeforms() {\n\t\treturn [\"skulk\", \"gorge\", \"lerk\", \"fade\", \"onos\", \"commander\"];\n\t},\n\n\tgathererLifeforms() {\n\t\tlet lifeforms = [];\n\t\tlet gatherer = this.props.gatherer;\n\t\tlet abilities = gatherer.user.profile.abilities;\n\t\tfor (let attr in abilities) {\n\t\t\tif (abilities[attr]) lifeforms.push(_.capitalize(attr));\n\t\t}\n\t\treturn lifeforms;\n\t},\n\n\trender() {\n\t\tlet lifeforms = this.gathererLifeforms();\t\n\t\tlet availableLifeforms = this.availableLifeforms();\n\t\tlet icons = availableLifeforms.map(lifeform => {\n\t\t\tlet containsAbility = lifeforms.some(gathererLifeform => {\n\t\t\t\treturn gathererLifeform.toLowerCase() === lifeform.toLowerCase()\n\t\t\t});\n\t\t\tif (containsAbility) {\n\t\t\t\treturn <img \n\t\t\t\t\tclassName=\"lifeform-icon\"\n\t\t\t\t\tkey={lifeform}\n\t\t\t\t\tsrc={`/${lifeform.toLowerCase()}.png`} />\n\t\t\t} else {\n\t\t\t\treturn <img \n\t\t\t\t\tclassName=\"lifeform-icon\"\n\t\t\t\t\tkey={lifeform}\n\t\t\t\t\tsrc={`/blank.gif`} />\n\t\t\t}\n\t\t});\n\t\treturn <span className=\"add-right hidden-xs\">{icons}</span>\n\t}\n});\n\nconst Gatherers = React.createClass({\n\tpropTypes: {\n\t\tuser: React.PropTypes.object,\n\t\tthisGatherer: React.PropTypes.object,\n\t\tsocket: React.PropTypes.object.isRequired,\n\t\tgather: React.PropTypes.object.isRequired\n\t},\n\n\tjoinGather(e) {\n\t\te.preventDefault();\n\t\tthis.props.socket.emit(\"gather:join\");\n\t},\n\n\tbootGatherer(e) {\n\t\te.preventDefault();\n\t\tthis.props.socket.emit(\"gather:leave\", {\n\t\t\tgatherer: parseInt(e.target.value, 10) || null\n\t\t});\n\t},\n\n\trender() {\n\t\tconst self = this;\n\t\tconst user = this.props.user;\n\t\tconst socket = this.props.socket;\n\t\tconst gather = this.props.gather;\n\t\tconst thisGatherer = this.props.thisGatherer;\n\t\tconst admin = (user && user.admin) || (user && user.moderator);\n\t\tconst gatherers = gather.gatherers\n\t\t.sort((a, b) => {\n\t\t\t\treturn (b.user.hive.skill || 1000) - (a.user.hive.skill || 1000);\n\t\t\t})\n\t\t.map(gatherer => {\n\t\t\tlet country;\n\t\t\tif (gatherer.user.country) {\n\t\t\t\tcountry = (\n\t\t\t\t\t<img src=\"/blank.gif\" \n\t\t\t\t\t\tclassName={\"flag flag-\" + gatherer.user.country.toLowerCase()} \n\t\t\t\t\t\talt={gatherer.user.country} />\n\t\t\t\t);\n\t\t\t};\n\n\t\t\tlet skill = gatherer.user.profile.skill || \"Not Available\";\n\n\t\t\tlet hiveStats = [];\n\t\t\tif (gatherer.user.hive.skill) hiveStats.push(`${gatherer.user.hive.skill} ELO`);\n\n\t\t\tif (gatherer.user.hive.playTime) {\n\t\t\t\thiveStats.push(`${Math.floor(gatherer.user.hive.playTime / 3600)} Hours`);\n\t\t\t}\n\n\t\t\tlet hive = (hiveStats.length) ? hiveStats.join(\", \") : \"Not Available\";\n\t\t\t\n\t\t\tlet team = (gatherer.user.team) ? gatherer.user.team.name : \"None\";\n\n\t\t\tlet action;\n\t\t\tif (gather.state === \"election\") {\n\t\t\t\tlet votes = gather.gatherers.reduce((acc, voter) => {\n\t\t\t\t\tif (voter.leaderVote === gatherer.id) acc++;\n\t\t\t\t\treturn acc;\n\t\t\t\t}, 0)\n\t\t\t\taction = (\n\t\t\t\t\t<span>\n\t\t\t\t\t\t<span className=\"badge add-right\">{votes + \" votes\"}</span>\n\t\t\t\t\t\t<VoteButton \n\t\t\t\t\t\t\tthisGatherer={thisGatherer} \n\t\t\t\t\t\t\tsoundController={this.props.soundController}\n\t\t\t\t\t\t\tcandidate={gatherer} />\n\t\t\t\t\t</span>\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (gather.state === 'selection') {\n\t\t\t\tif (thisGatherer && \n\t\t\t\t\t\tthisGatherer.leader &&\n\t\t\t\t\t\tthisGatherer.team === gather.pickingTurn) {\n\t\t\t\t\taction = (\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t<SelectPlayerButton gatherer={gatherer} />\n\t\t\t\t\t\t</span>\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tif (gatherer.leader) {\n\t\t\t\t\t\taction = (<span className={`label label-padding \n\t\t\t\t\t\t\tlabel-${gatherer.team} \n\t\t\t\t\t\t\tteam-label`}>Leader</span>);\n\t\t\t\t\t} else if (gatherer.team !== \"lobby\") {\n\t\t\t\t\t\taction = (<span className={`label label-padding \n\t\t\t\t\t\t\tlabel-${gatherer.team} \n\t\t\t\t\t\t\tteam-label`}>{_.capitalize(gatherer.team)}</span>);\n\t\t\t\t\t} else {\n\t\t\t\t\t\taction = (<span className=\"label label-padding label-default team-label\">\n\t\t\t\t\t\t\tLobby</span>);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet adminOptions;\n\t\t\tif (admin) {\n\t\t\t\tadminOptions = [\n\t\t\t\t\t<hr />,\n\t\t\t\t\t<dt>Admin</dt>,\n\t\t\t\t\t<dd>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclassName=\"btn btn-xs btn-danger\"\n\t\t\t\t\t\t\tvalue={gatherer.user.id}\n\t\t\t\t\t\t\tonClick={this.bootGatherer}>\n\t\t\t\t\t\t\tBoot from Gather\n\t\t\t\t\t\t</button>&nbsp;\n\t\t\t\t\t\t<AssumeUserIdButton socket={socket}\n\t\t\t\t\t\t\tgatherer={gatherer} currentUser={user} />\n\t\t\t\t\t</dd>\n\t\t\t\t]\n\t\t\t}\n\n\t\t\tlet tabColor = gatherer.team !== \"lobby\" ? `panel-${gatherer.team}` : \"panel-info\";\n\t\t\treturn (\n\t\t\t\t<div className={`panel ${tabColor} gatherer-panel`} \n\t\t\t\t\tkey={gatherer.user.id} data-userid={gatherer.user.id}>\n\t\t\t\t\t<div className=\"panel-heading\">\n\t\t\t\t\t\t<h4 className=\"panel-title\">\n\t\t\t\t\t\t\t{country} {gatherer.user.username}\n\t\t\t\t\t\t\t<span className=\"pull-right\">\n\t\t\t\t\t\t\t\t<a data-toggle=\"collapse\"\n\t\t\t\t\t\t\t\t\thref={\"#\"+gatherer.user.id.toString() + \"-collapse\"} \n\t\t\t\t\t\t\t\t\taria-expanded=\"false\" \n\t\t\t\t\t\t\t\t\tclassName=\"btn btn-xs btn-primary add-right\"\n\t\t\t\t\t\t\t\t\taria-controls={gatherer.user.id.toString() + \"-collapse\"}>\n\t\t\t\t\t\t\t\t\tInfo <span className=\"caret\"></span></a>\n\t\t\t\t\t\t\t\t<LifeformIcons gatherer={gatherer} />\n\t\t\t\t\t\t\t\t{action}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</h4>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div id={gatherer.user.id.toString() + \"-collapse\"} \n\t\t\t\t\t\tclassName=\"panel-collapse collapse out\" >\n\t\t\t\t\t\t<div className=\"panel-body\">\n\t\t\t\t\t\t\t<dl className=\"dl-horizontal\">\n\t\t\t\t\t\t\t\t<dt>Skill Level</dt>\n\t\t\t\t\t\t\t\t<dd>{skill}</dd>\n\t\t\t\t\t\t\t\t<dt>Team</dt>\n\t\t\t\t\t\t\t\t<dd>{team}</dd>\n\t\t\t\t\t\t\t\t<dt>Hive Stats</dt>\n\t\t\t\t\t\t\t\t<dd>{hive}</dd>\n\t\t\t\t\t\t\t\t<dt>Links</dt>\n\t\t\t\t\t\t\t\t<dd>\n\t\t\t\t\t\t\t\t\t<a href={enslUrl(gatherer)} \n\t\t\t\t\t\t\t\t\t\tclassName=\"btn btn-xs btn-primary\"\n\t\t\t\t\t\t\t\t\t\ttarget=\"_blank\">ENSL Profile</a>&nbsp;\n\t\t\t\t\t\t\t\t\t<a href={hiveUrl(gatherer)} \n\t\t\t\t\t\t\t\t\t\tclassName=\"btn btn-xs btn-primary\"\n\t\t\t\t\t\t\t\t\t\ttarget=\"_blank\">Hive Profile</a>\n\t\t\t\t\t\t\t\t</dd>\n\t\t\t\t\t\t\t\t{adminOptions}\n\t\t\t\t\t\t\t</dl>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t);\n\t\t})\n\t\tif (gather.gatherers.length) {\n\t\t\treturn (\n\t\t\t\t<div class=\"panel-group\" \n\t\t\t\t\trole=\"tablist\" \n\t\t\t\t\taria-multiselectable=\"true\" \n\t\t\t\t\tid=\"gatherers-panel\">\n\t\t\t\t\t{gatherers}\n\t\t\t\t</div>\n\t\t\t);\n\t\t} else {\n\t\t\treturn (\n\t\t\t\t<div className=\"panel panel-primary add-bottom\">\n\t\t\t\t\t<div className=\"panel-body text-center join-hero\">\n\t\t\t\t\t\t<button \n\t\t\t\t\t\t\tonClick={this.joinGather} \n\t\t\t\t\t\t\tclassName=\"btn btn-success btn-lg\">Start a Gather</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\t}\n});\n\nconst CompletedGather = React.createClass({\n\tcompletionDate() {\n\t\tlet d = new Date(this.props.gather.done.time);\n\t\tif (d) {\n\t\t\treturn d.toLocaleTimeString();\n\t\t} else {\n\t\t\treturn \"Completed Gather\"\n\t\t}\n\t},\n\n\tgetInitialState() {\n\t\treturn {\n\t\t\tshow: !!this.props.show\n\t\t};\n\t},\n\n\ttoggleGatherInfo() {\n\t\tlet newState = !this.state.show;\n\t\tthis.setState({\n\t\t\tshow: newState\n\t\t});\n\t},\n\n\trender() {\n\t\tlet gatherInfo = [];\n\t\tlet gather = this.props.gather;\n\t\tlet maps = this.props.maps;\n\t\tlet servers = this.props.servers;\n\t\tif (this.state.show) {\n\t\t\tgatherInfo.push(<GatherTeams gather={gather} />);\n\t\t\tgatherInfo.push(<GatherVotingResults gather={gather} \n\t\t\t\tmaps={maps} \n\t\t\t\tservers={servers}/>);\n\t\t}\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<div className=\"panel panel-success add-bottom pointer\"\n\t\t\t\t\tonClick={this.toggleGatherInfo}>\n\t\t\t\t\t<div className=\"panel-heading\"><strong>{this.completionDate()}</strong></div>\n\t\t\t\t</div>\n\t\t\t\t{gatherInfo}\n\t\t\t</div>\n\t\t);\n\t}\n});\n\nconst GatherVotingResults = React.createClass({\n\t// Returns an array of ids voted for e.g. [1,2,5,1,1,3,2]\n\tcountVotes(voteType) {\n\t\treturn this.props.gather.gatherers.reduce((acc, gatherer) => {\n\t\t\tlet votes = gatherer[voteType];\n\n\t\t\t// Temporary fix because some mapvotes are ints and not arrays\n\t\t\tif (!Array.isArray(votes)) votes = [votes];\n\n\t\t\tif (votes.length > 0) votes.forEach(vote => acc.push(vote));\n\t\t\treturn acc;\n\t\t}, []);\n\t},\n\n\tselectedMaps() {\n\t\treturn rankVotes(this.countVotes('mapVote'), this.props.maps).slice(0, 2)\n\t},\n\n\tselectedServer() {\n\t\treturn rankVotes(this.countVotes('serverVote'), this.props.servers).slice(0, 1);\n\t},\n\n\trender() {\n\t\tlet maps = this.selectedMaps();\n\t\tlet server = this.selectedServer().pop();\n\t\tlet password;\n\t\tif (server.password) {\n\t\t\tpassword = [\n\t\t\t\t<dt>Password</dt>,\n\t\t\t\t<dd>{server.password}</dd>\n\t\t\t];\n\t\t}\n\t\treturn (\n\t\t\t<div className=\"panel panel-primary\">\n\t\t\t\t<div className=\"panel-heading\">\n\t\t\t\t\tServer\n\t\t\t\t</div>\n\t\t\t\t<div className=\"panel-body\">\n\t\t\t\t\t<dl className=\"dl-horizontal\">\n\t\t\t\t\t\t<dt>Maps</dt>\n\t\t\t\t\t\t<dd>{maps.map(map => map.name).join(\" & \")}</dd>\n\t\t\t\t\t\t<dt>Server</dt>\n\t\t\t\t\t\t<dd>{server.name}</dd>\n\t\t\t\t\t\t<dt>Address</dt>\n\t\t\t\t\t\t<dd>{server.ip}:{server.port}</dd>\n\t\t\t\t\t\t{password}\n\t\t\t\t\t</dl>\n\t\t\t\t\t<p>\n\t\t\t\t\t\t<a href={`steam://run/4920/connect+%20${server.ip}:${server.port}%20+password%20${server.password}`}\n\t\t\t\t\t\t\tclassName=\"btn btn-primary max-width\">Join Server</a>\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n});\n\nconst ArchivedGathers = exports.ArchivedGathers = React.createClass({\n\tpropTypes: {\n\t\tarchive: React.PropTypes.array.isRequired,\n\t\tservers: React.PropTypes.array.isRequired,\n\t\tmaps: React.PropTypes.array.isRequired\n\t},\n\n\trender() {\n\t\tlet archive = this.props.archive\n\t\t\t.sort((a, b) => {\n\t\t\t\treturn new Date(b.createdAt) - new Date(a.createdAt);\n\t\t\t})\n\t\t\t.map((archivedGather, index) => {\n\t\t\t\treturn <CompletedGather \n\t\t\t\t\tid={archivedGather.gather.done.time}\n\t\t\t\t\tshow={(index === 0) ? true : false}\n\t\t\t\t\tgather={archivedGather.gather} \n\t\t\t\t\tmaps={this.props.maps}\n\t\t\t\t\tservers={this.props.servers} />\n\t\t\t});\n\n\t\treturn (\n\t\t\t<div className=\"panel panel-primary\">\n\t\t\t\t<div className=\"panel-heading\">Archived Gathers</div>\n\t\t\t\t<div className=\"panel-body\">\n\t\t\t\t\t{archive}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n});\n","import {Events} from \"javascripts/components/event\";\nimport {CurrentUser, AdminPanel, ProfileModal, UserMenu} from \"javascripts/components/user\";\nimport {SoundPanel} from \"javascripts/components/sound\";\nimport {TeamSpeakButton, TeamSpeakModal} from \"javascripts/components/teamspeak\";\nimport {SettingsPanel} from \"javascripts/components/settings\";\nimport {Chatroom} from \"javascripts/components/message\";\nimport {Gather, ArchivedGathers} from \"javascripts/components/gather\"\n\nconst React = require(\"react\");\nconst Sound = require(\"javascripts/components/sound\");\nconst SoundController = Sound.SoundController;\nconst helper = require(\"javascripts/helper\");\nconst storageAvailable = helper.storageAvailable;\nconst SplashScreen = React.createClass({\n\tgetInitialState() {\n\t\treturn {\n\t\t\tstatus: \"connecting\",\n\t\t\tsocket: null\n\t\t}\n\t},\n\n\tcomponentDidMount() {\n\t\tconst socketUrl = window.location.protocol + \"//\" + window.location.host;\n\t\tlet socket = io(socketUrl)\n\t\t\t.on(\"connect\", () => {\n\t\t\t\tconsole.log(\"Connected\");\n\t\t\t\tthis.setState({ status: \"connected\" });\n\t\t\t\tsocket\n\t\t\t\t\t.on(\"reconnect\", () => {\n\t\t\t\t\t\tconsole.log(\"Reconnected\");\n\t\t\t\t\t})\n\t\t\t\t\t.on(\"disconnect\", () => {\n\t\t\t\t\t\tconsole.log(\"Disconnected\")\n\t\t\t\t\t});\n\t\t\t})\n\t\t\t.on(\"error\", error => {\n\t\t\t\tconsole.log(error);\n\t\t\t\tif (error === \"Authentication Failed\") {\n\t\t\t\t\tthis.setState({ status: \"authFailed\" });\n\t\t\t\t} else if (error === \"Gather Banned\") {\n\t\t\t\t\tthis.setState({ status: \"banned\" });\n\t\t\t\t}\n\t\t\t});\n\n\t\tthis.setState({ socket: socket });\n\t},\n\n\trender() {\n\t\tconst status = this.state.status;\n\n\t\tif (status === \"connected\") {\n\t\t\treturn <App socket={this.state.socket} />;\n\t\t} \n\n\t\tlet splash;\n\t\tif (status === \"authFailed\") {\n\t\t\tsplash = <AuthFailedSplash />;\n\t\t} else if (status === \"banned\") {\n\t\t\tsplash = <BannedSplash />;\n\t\t} else if (status === \"connecting\") {\n\t\t\tsplash = <ConnectingSplash />;\n\t\t}\n\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<div style={{\"minHeight\": \"750px\"}}>\n\t\t\t\t\t<div className=\"container-fluid\">\n\t\t\t\t\t\t{splash}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n});\n\nconst AuthFailedSplash = React.createClass({\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"row\" id=\"auth-required\">\n\t\t\t\t<div className=\"col-lg-6 col-lg-offset-3\">\n\t\t\t\t\t<div className=\"add-top jumbotron jumbo-auth text-center\">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<img src=\"/ensl_logo.png\" alt=\"ENSL Logo\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<h3>You need to be logged in to the ENSL website to access gathers</h3>\n\t\t\t\t\t\t<h3><small>If you are logged on, try visiting a few pages on ENSL.org so the server can update your cookies</small></h3>\n\t\t\t\t\t\t<h3><small>If this error persists please contact an admin to fix it</small></h3>\n\t\t\t\t\t\t<br />\n\t\t\t\t\t  <p><a className=\"btn btn-primary btn-lg\" href=\"www.ensl.org\" role=\"button\">Go to website</a></p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n});\n\nconst BannedSplash = React.createClass({\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"row\">\n\t\t\t\t<div className=\"col-lg-6 col-lg-offset-3\">\n\t\t\t\t\t<div className=\"add-top jumbotron jumbo-auth text-center\">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<img src=\"/ensl_logo.png\" alt=\"ENSL Logo\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<h3>You're currently barred from joining gathers</h3>\n\t\t\t\t\t\t<h3><small>Either wait for the ban to expire or talk to an admin to get it lifted</small></h3>\n\t\t\t\t\t\t<br />\n\t\t\t\t\t  <p><a className=\"btn btn-primary btn-lg\" href=\"http://www.ensl.org/bans\" role=\"button\">See the ban list</a></p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n});\n\nconst ConnectingSplash = React.createClass({\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"row\" id=\"authenticating\">\n\t\t\t\t<div className=\"col-lg-6 col-lg-offset-3\">\n\t\t\t\t\t<div className=\"add-top jumbotron jumbo-auth text-center\">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<img src=\"/ensl_logo.png\" className=\"jumbo-img\" alt=\"ENSL Logo\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t<h3>Authenticating your ENSL account</h3>\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<img src=\"/spinner.svg\" className=\"spinner\" alt=\"Loading\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n});\n\nconst App = React.createClass({\n\tpropTypes: {\n\t\tsocket: React.PropTypes.object.isRequired\n\t},\n\n\tgetInitialState() {\n\t\tlet updateTitle = true;\n\t\tlet showEventsPanel = true;\n\n\t\tif (storageAvailable('localStorage')) {\n\t\t\tif (localStorage.getItem(\"updateTitle\") !== null) {\n\t\t\t\tupdateTitle = JSON.parse(localStorage.getItem(\"updateTitle\"));\n\t\t\t}\n\t\t\tif (localStorage.getItem(\"showEventsPanel\") !== null) {\n\t\t\t\tshowEventsPanel = JSON.parse(localStorage.getItem(\"showEventsPanel\"));\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tgather: {\n\t\t\t\tgatherers: []\n\t\t\t},\n\t\t\tusers: [],\n\t\t\tmessages: [],\n\t\t\tmaps: [],\n\t\t\tuser: null,\n\t\t\tservers: [],\n\t\t\tarchive: [],\n\t\t\tsocket: null,\n\t\t\tevents: [],\n\t\t\tupdateTitle: updateTitle,\n\t\t\tshowEventsPanel: showEventsPanel,\n\t\t\tsoundController: new SoundController(),\n\t\t\tshowMessageBox: true,\n\t\t\tcollapseMenu: false\n\t\t};\n\t},\n\n\tupdateTitle() {\n\t\tlet gather = this.state.gather;\n\t\tif (gather && this.state.updateTitle) {\n\t\t\tdocument.title = `NSL Gathers (${gather.gatherers.length}/12)`;\n\t\t\treturn;\n\t\t}\n\t\tdocument.title = \"NSL Gathers\";\n\t},\n\n\ttoggleEventsPanel(event) {\n\t\tlet newState = event.target.checked;\n\t\tthis.setState({ showEventsPanel: newState });\n\t\tif (storageAvailable('localStorage')) {\n\t\t\tlocalStorage.setItem(\"showEventsPanel\", newState)\n\t\t}\n\t},\n\n\ttoggleUpdateTitle(event) {\n\t\tlet newState = event.target.checked;\n\t\tthis.setState({ updateTitle: newState });\n\t\tif (storageAvailable('localStorage')) {\n\t\t\tlocalStorage.setItem(\"updateTitle\", newState)\n\t\t}\n\t\tthis.updateTitle();\n\t},\n\n\tthisGatherer() {\n\t\tlet gather = this.state.gather;\n\t\tlet user = this.state.user;\n\t\tif (gather && user && gather.gatherers.length) {\n\t\t\treturn gather.gatherers\n\t\t\t\t.filter(gatherer => gatherer.id === user.id)\n\t\t\t\t.pop() || null;\n\t\t}\n\t\treturn null;\n\t},\n\n\tcomponentDidMount() {\n\t\tlet self = this;\n\t\tlet socket = this.props.socket;\n\t\tlet soundController = this.state.soundController;\n\n\t\tthis.updateTitle();\n\n\t\tsocket.on('stateChange', data => {\n\t\t\tlet state = data.state;\n\t\t\t\n\t\t\tif (state.from === 'gathering'\n\t\t\t\t\t&& state.to === 'election'\n\t\t\t\t\t&& this.thisGatherer()) {\n\t\t\t\tsoundController.playGatherMusic();\n\t\t\t}\n\n\t\t\tif (state.from === 'election'\n\t\t\t\t\t&& state.to === 'gathering') {\n\t\t\t\tsoundController.stop();\n\t\t\t}\n\t\t});\n\n\t\tsocket.on('event:append', data => {\n\t\t\tlet events = self.state.events;\n\t\t\tevents.unshift(data);\n\t\t\tself.setState({\n\t\t\t\tevents: events.slice(0, 20)\n\t\t\t});\n\t\t});\n\n\t\tsocket.on('users:update', \n\t\t\tdata => self.setState({\n\t\t\t\tusers: data.users,\n\t\t\t\tuser: data.currentUser\n\t\t\t})\n\t\t);\n\n\t\tsocket.on(\"message:append\", data => {\n\t\t\tself.setState({\n\t\t\t\tmessages: self.state.messages.concat(data.messages)\n\t\t\t\t\t.sort((a, b) => {\n\t\t\t\t\t\treturn new Date(a.createdAt) - new Date(b.createdAt);\n\t\t\t\t\t})\n\t\t\t});\n\t\t});\n\n\t\tsocket.on(\"message:refresh\", data => {\n\t\t\tself.setState({\n\t\t\t\tmessages: data.messages\n\t\t\t});\n\t\t});\n\n\t\tsocket.on(\"gather:refresh\", (data) => {\n\t\t\tself.setState({\n\t\t\t\tgather: data.gather,\n\t\t\t\tmaps: data.maps,\n\t\t\t\tservers: data.servers,\n\t\t\t\tpreviousGather: data.previousGather\n\t\t\t});\n\t\t\tthis.updateTitle();\n\t\t});\n\n\t\tsocket.on(\"gather:archive:refresh\", data => {\n\t\t\tself.setState({\n\t\t\t\tarchive: data.archive,\n\t\t\t\tmaps: data.maps,\n\t\t\t\tservers: data.servers\n\t\t\t});\n\t\t});\n\n\t\tsocket.emit(\"users:refresh\");\n\t\tsocket.emit(\"message:refresh\");\n\t\tsocket.emit(\"gather:refresh\");\n\t},\n\n\ttoggleMessageBox(e) {\n\t\te.preventDefault();\n\t\tconsole.log(\"FOO\")\n\t\tthis.setState({\n\t\t\tshowMessageBox: !this.state.showMessageBox\n\t\t});\n\t},\n\n\ttoggleCollapseMenu(e) {\n\t\te.preventDefault();\n\t\tthis.setState({\n\t\t\tcollapseMenu: !this.state.collapseMenu\n\t\t});\n\t},\n\n\trender() {\n\t\tconst socket = this.props.socket;\n\n\t\tlet eventsPanel;\n\t\tif (this.state.showEventsPanel) {\n\t\t\teventsPanel = <Events events={this.state.events} />;\n\t\t}\n\n\t\tlet profileModal, chatroom, currentUser;\n\t\tif (this.state.user) {\n\t\t\tprofileModal = <ProfileModal user={this.state.user} />;\n\t\t\tchatroom = <Chatroom messages={this.state.messages} \n\t\t\t\t\t\t\t\t\tuser={this.state.user} socket={socket} />;\n\t\t\tcurrentUser = (\n\t\t\t\t<ul className=\"nav navbar-top-links navbar-right\" id=\"currentuser\">\n\t\t\t  \t<CurrentUser user={this.state.user} />\n\t\t\t  </ul>\n\t\t\t);\n\t\t}\n\n\t\tlet appClass = [\"skin-blue\", \"sidebar-mini\", \"fixed\"];\n\t\tif (this.state.showMessageBox) appClass.push(\"control-sidebar-open\");\n\t\tif (this.state.collapseMenu) appClass.push(\"sidebar-collapse\");\n\n\t\treturn (\n\t\t\t<div className={appClass.join(\" \")}>\n\t\t\t  <header className=\"main-header\">\n\t\t\t  \t<a href=\"/\" className=\"logo\">\n\t\t\t\t\t\t<span className=\"logo-mini\">NSL Gathers</span>\n\t\t\t\t\t\t<span className=\"logo-lg\">NSL Gathers</span>\n\t\t\t\t\t</a>\n\t\t\t\t\t<nav className=\"navbar navbar-static-top\" role=\"navigation\">      \n\t\t\t\t\t  <a href=\"#\" className=\"sidebar-toggle\" onClick={this.toggleCollapseMenu} role=\"button\">\n\t\t\t\t\t    <span className=\"sr-only\">Toggle navigation</span>\n\t\t\t\t\t  </a>\n\t\t\t\t\t  <div className=\"navbar-custom-menu\">\n\t\t\t\t\t    <ul className=\"nav navbar-nav\">    \n\t\t\t\t\t    \t<li className=\"dropdown messages-menu\">\n\t\t\t\t\t        <a href=\"#\">\n\t\t\t\t\t          <i className=\"fa fa-headphones\"></i>\n\t\t\t\t\t        </a>\n\t\t\t\t        </li>\n\t\t\t\t\t      <li className=\"dropdown messages-menu\">\n\t\t\t\t\t        <a href=\"#\">\n\t\t\t\t\t          <i className=\"fa fa-newspaper-o\"></i>\n\t\t\t\t\t          <span className=\"label label-success\">4</span>\n\t\t\t\t\t        </a>\n\t\t\t\t        </li>\n\t\t\t\t        <li>\n\t\t\t            <a href=\"#\" onClick={this.toggleMessageBox}><i className=\"fa fa-comment\"></i></a>\n\t\t\t          </li>\n\t\t\t        </ul>\n\t\t        </div>\n\t        </nav>\n\t\t\t  </header>\n\t\t\t  <aside className=\"main-sidebar\">\n\t\t\t    <section className=\"sidebar\" style={{height: \"auto\"}}>\n\t\t\t      <div className=\"user-panel\">\n\t\t\t        <div className=\"pull-left image\">\n\t\t\t          <img src=\"http://www.ensl.org/images/icons/noavatar.png\" className=\"img-circle\" alt=\"User Image\" />\n\t\t\t        </div>\n\t\t\t        <div className=\"pull-left info\">\n\t\t\t          <p>User Name</p>\n\t\t\t          <a href=\"#\"><i className=\"fa fa-circle text-success\"></i> Online</a>\n\t\t\t        </div>\n\t\t\t      </div>\n\t\t\t      <ul className=\"sidebar-menu\">\n\t\t\t        <li className=\"header\">MAIN NAVIGATION</li>\n\t\t\t        <li>\n\t\t\t        \t<a href=\"#\">\n\t\t\t            <i className=\"fa fa-dashboard\"></i> <span>Online</span>\n\t\t\t          </a>\n\t\t          </li>\n\t\t          <li>\n\t\t\t        \t<a href=\"#\">\n\t\t\t            <i className=\"fa fa-dashboard\"></i> <span>Teamspeak</span>\n\t\t\t          </a>\n\t\t          </li>\n\t\t          <li>\n\t\t\t        \t<a href=\"#\">\n\t\t\t            <i className=\"fa fa-dashboard\"></i> <span>Info</span>\n\t\t\t          </a>\n\t\t          </li>\n\t\t\t      </ul>\n\t\t\t    </section>\n\t\t\t  </aside>\n\t\t\t  <div className=\"content-wrapper\" style={{\"minHeight\": \"916px\"}}>\n\t\t\t    <section className=\"content-header\">\n\t\t\t      <h1>Gathers<small>beta</small></h1>\n\t\t\t    </section>\n\t\t\t\t  <section className=\"content\">\n\t\t\t\t  \t<p>Foo</p>\n\t\t\t\t  </section>\n\t\t\t\t</div>\n\t\t\t\t<aside className=\"control-sidebar control-sidebar-dark\" style={{\"position\": \"fixed\", \"height\": \"auto\"}}>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<h3 className=\"control-sidebar-heading\">Recent Activity</h3>\n\t\t\t\t\t\t\t<ul className=\"control-sidebar-menu\">\n\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t<a href=\"#\">\n\t\t\t\t\t\t\t\t\t\t<i className=\"menu-icon fa fa-birthday-cake bg-red\"></i>\n\t\t\t\t\t\t\t\t\t\t<div className=\"menu-info\">\n\t\t\t\t\t\t\t\t\t\t\t<h4 className=\"control-sidebar-subheading\">Langdon's Birthday</h4>\n\t\t\t\t\t\t\t\t\t\t\t<p>Will be 23 on April 24th</p>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</aside>\n\t\t\t\t<div className=\"control-sidebar-bg\" style={{\"position\":\"fixed\", \"height\":\"auto\"}}></div>\n\t\t  </div>\n\t\t);\n\n\t\treturn (\n\t\t\t<div id=\"wrapper\">\n\t\t\t\t<nav className=\"navbar navbar-default navbar-static-top\" \n\t\t\t\t\trole=\"navigation\" \n\t\t\t\t\tstyle={{marginBottom: \"0\"}}>\n\t\t\t\t\t<div className=\"navbar-header\">\n\t\t\t\t\t\t<a className=\"navbar-brand\" href=\"/\">NSL Gathers <small><i>Alpha</i></small></a>\n\t\t\t\t\t</div>\n\t\t\t\t\t{currentUser}\n\t\t\t\t  <ul className=\"nav navbar-top-links navbar-right\" id=\"soundcontroller\">\n\t\t\t\t  \t<SoundPanel soundController={this.state.soundController} />\n\t\t\t\t  </ul>\n\t\t\t\t  <TeamSpeakButton />\n\t\t\t\t  <ul className=\"nav navbar-top-links navbar-right\">\n\t\t\t\t\t  <li className=\"dropdown\">\n\t\t\t\t\t\t\t<a href=\"#\">\n\t\t\t\t\t\t\t\tInfo &nbsp;<i className=\"fa fa-caret-down\"></i>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t<ul className=\"dropdown-menu\">\n\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t<a href=\"https://github.com/cblanc/sws_gathers\" target=\"_blank\">\n\t\t\t\t\t\t\t\t\t\t<i className=\"fa fa-github\">&nbsp;</i>&nbsp;Github\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t<a href=\"http://steamcommunity.com/id/nslgathers\" target=\"_blank\">\n\t\t\t\t\t\t\t\t\t\t<i className=\"fa fa-external-link\">&nbsp;</i>&nbsp;Steam Bot\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t<a href=\"http://www.ensl.org/articles/464\" target=\"_blank\">\n\t\t\t\t\t\t\t\t\t\t<i className=\"fa fa-external-link\">&nbsp;</i>&nbsp;Gather Rules\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t<a href=\"/messages\" target=\"_blank\">\n\t\t\t\t\t\t\t\t\t\t<i className=\"fa fa-external-link\">&nbsp;</i>&nbsp;Message Archive\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t</li>\n\t\t\t\t  </ul>\n\t\t\t\t</nav>\n\t\t\t\t<AdminPanel socket={socket} />\n\t\t\t\t<SettingsPanel \n\t\t\t\t\ttoggleEventsPanel={this.toggleEventsPanel}\n\t\t\t\t\tshowEventsPanel={this.state.showEventsPanel}\n\t\t\t\t\ttoggleUpdateTitle={this.toggleUpdateTitle}\n\t\t\t\t\tupdateTitle={this.state.updateTitle} />\n\t\t\t\t<TeamSpeakModal />\n\t\t\t\t{profileModal}\n\t\t\t\t<div style={{minHeight: \"750px\"}}>\n\t\t\t\t\t<div className=\"container-fluid\">\n\t\t\t\t\t\t<div className=\"row\">\n\t\t\t\t\t\t\t<div className=\"col-md-2 hidden-xs\">\n\t\t\t\t\t\t\t\t<ul className=\"nav\" id=\"side-menu\">\n\t\t\t\t\t\t\t\t\t<UserMenu users={this.state.users} user={this.state.user} \n\t\t\t\t\t\t\t\t\t\tsocket={socket} />\n\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"col-md-4\" id=\"chatroom\">\n\t\t\t\t\t\t\t\t{chatroom}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"col-md-6\" id=\"gathers\">\n\t\t\t\t\t\t\t\t<Gather \n\t\t\t\t\t\t\t\t\tsocket={socket}\n\t\t\t\t\t\t\t\t\tmaps={this.state.maps}\n\t\t\t\t\t\t\t\t\tuser={this.state.user} \n\t\t\t\t\t\t\t\t\tgather={this.state.gather}\n\t\t\t\t\t\t\t\t\tservers={this.state.servers}\n\t\t\t\t\t\t\t\t\tthisGatherer={this.thisGatherer()}\n\t\t\t\t\t\t\t\t\tpreviousGather={this.state.previousGather}\n\t\t\t\t\t\t\t\t\tsoundController={this.state.soundController} />\n\t\t\t\t\t\t\t\t{eventsPanel}\n\t\t\t\t\t\t\t\t<hr />\n\t\t\t\t\t\t\t\t<ArchivedGathers archive={this.state.archive}\n\t\t\t\t\t\t\t\t\tmaps={this.state.maps}\n\t\t\t\t\t\t\t\t\tservers={this.state.servers} />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n});\n\nmodule.exports = SplashScreen;\n","const React = require(\"react\");\nconst ReactDOM = require(\"react-dom\");\nconst ReactEmoji = require(\"react-emoji\");\nconst ReactAutolink = require(\"react-autolink\");\nconst MessageBrowser = React.createClass({\n\tgetInitialState() {\n\t\treturn {\n\t\t\tbrowserState: \"\",\n\t\t\tmessages: [],\n\t\t\tpage: 0,\n\t\t\tlimit: 250,\n\t\t\tsearch: \"\"\n\t\t}\n\t},\n\n\thandleNextPage(e) {\n\t\te.preventDefault();\n\t\tconst page = this.state.page;\n\t\tthis.setState({ page: page + 1 });\n\t\tthis.loadMessages();\n\t},\n\n\thandlePreviousPage(e) {\n\t\te.preventDefault();\n\t\tconst page = this.state.page;\n\t\tif (page < 1) return;\n\t\tthis.setState({ page: page - 1 });\n\t\tthis.loadMessages();\n\t},\n\n\tpageHandlers() {\n\t\tlet previous;\n\t\tif (this.state.page > 0) {\n\t\t\tprevious = (\n\t\t\t\t<a className=\"btn btn-xs btn-primary add-right\"\n\t\t\t\t\tonClick={this.handlePreviousPage}>Prev</a>\n\t\t\t);\n\t\t}\n\t\tlet next;\n\t\tif (this.state.messages.length === this.state.limit) {\n\t\t\tnext = (\n\t\t\t\t<a className=\"btn btn-xs btn-primary\" \n\t\t\t\t\tonClick={this.handleNextPage}>Next</a>\n\t\t\t);\n\t\t}\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t{previous}\n\t\t\t\t<span className=\"add-right\">\n\t\t\t\t\t{this.state.page}\n\t\t\t\t</span>\n\t\t\t\t{next}\n\t\t\t</div>\n\t\t);\n\t},\n\n\tloadMessages() {\n\t\tconst limit = this.state.limit;\n\t\tconst page = this.state.page;\n\t\tlet data = {\n\t\t\tlimit: limit,\n\t\t\tpage: page\n\t\t};\n\n\t\tif (this.state.search.length) {\n\t\t\tdata.query = this.state.search;\n\t\t}\n\n\t\tthis.setState({ browserState: \"Retrieving messages\"});\n\t\t$.ajax({\n\t\t\turl: \"/api/messages\",\n\t\t\tdata: data\n\t\t})\n\t\t.done(data => {\n\t\t\tthis.setState({\n\t\t\t\tmessages: data.messages,\n\t\t\t\tbrowserState: \"\"\n\t\t\t});\n\t\t})\n\t\t.fail(error => {\n\t\t\tconsole.error(error);\n\t\t\tthis.setState({\n\t\t\t\tbrowserState: `Unable to retrieve messages.`\n\t\t\t});\n\t\t})\n\t},\n\n\tcomponentDidMount() {\n\t\tthis.loadMessages();\n\t},\n\n\tupdateLimit(e) {\n\t\tlet newLimit = parseInt(e.target.value, 10);\n\t\tif (isNaN(newLimit) || newLimit > 250) newLimit = 250;\n\t\tthis.setState({ limit: newLimit });\n\t},\n\n\tupdateSearch(e) {\n\t\tthis.setState({ search: e.target.value });\n\t},\n\n\trender() {\n\t\tlet browserState;\n\t\tif (this.state.browserState.length) {\n\t\t\tbrowserState = (\n\t\t\t\t<div className=\"col-xs-7\">\n\t\t\t\t\t<div className=\"well\">{this.state.browserState}</div>\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\t\tconst messages = this.state.messages.map(message => {\n\t\t\treturn (\n\t\t\t\t<tr key={message._id}>\n\t\t\t\t\t<td className=\"col-xs-2\">{(new Date(message.createdAt)).toString()}</td>\n\t\t\t\t\t<td className=\"col-xs-3\">{message.author.username}</td>\n\t\t\t\t\t<td className=\"col-xs-5\">{message.content}</td>\n\t\t\t\t\t<td className=\"col-xs-2\">{message._id}</td>\n\t\t\t\t</tr>\n\t\t\t);\n\t\t});\n\t\treturn (\n\t\t\t<div className=\"row\">\n\t\t\t\t<div className=\"col-xs-5\">\n\t\t\t\t\t<div className=\"form-horizontal\">\n\t\t\t\t\t  <div className=\"form-group\">\n\t\t\t\t\t    <label className=\"col-sm-3 control-label\">Max Results</label>\n\t\t\t\t\t    <div className=\"col-sm-9\">\n\t\t\t\t\t      <input type=\"number\" className=\"form-control\" \n\t\t\t\t\t      \tonChange={this.updateLimit}\n\t\t\t\t\t      \tvalue={this.state.limit}></input>\n\t\t\t\t\t    </div>\n\t\t\t\t\t  </div>\n\t\t\t\t\t  <div className=\"form-group\">\n\t\t\t\t\t    <label className=\"col-sm-3 control-label\">Search Filter</label>\n\t\t\t\t\t    <div className=\"col-sm-9\">\n\t\t\t\t\t      <input type=\"text\" className=\"form-control\" \n\t\t\t\t\t      \tonChange={this.updateSearch}\n\t\t\t\t\t      \tvalue={this.state.search}></input>\n\t\t\t\t\t    </div>\n\t\t\t\t\t  </div>\n\t\t\t\t\t  <div className=\"form-group\">\n\t\t\t\t\t  \t<div className=\"col-sm-offset-3 col-sm-9\">\n\t\t\t\t\t\t  \t<button \n\t\t\t\t\t\t\t\t\tclassName=\"btn btn-primary\"\n\t\t\t\t\t\t\t\t\tonClick={this.loadMessages}>Search</button>\n\t\t\t\t\t  \t</div>\n\t\t\t\t\t  </div>\n\t\t\t\t\t  <div className=\"row\">\n\t\t\t\t\t\t  <div className=\"col-sm-offset-3 col-sm-9\">\n\t\t\t\t\t\t  \t<p>Page Control</p>\n\t\t\t\t\t\t  \t{this.pageHandlers()}\n\t\t\t\t\t  \t</div>\n\t\t\t\t  \t</div>\n\t\t\t\t  </div>\n\t\t\t\t</div>\n\t\t\t\t{browserState}\n\t\t\t\t<div className=\"col-xs-12\">\n\t\t\t\t\t<table className=\"table\">\n\t\t\t\t\t\t<thead>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<th>Date</th>\n\t\t\t\t\t\t\t\t<th>Author</th>\n\t\t\t\t\t\t\t\t<th>Message</th>\n\t\t\t\t\t\t\t\t<th>ID</th>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</thead>\n\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t\t{messages}\n\t\t\t\t\t\t</tbody>\n\t\t\t\t\t</table>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n});\n\nconst Chatroom = exports.Chatroom = React.createClass({\n\tpropTypes: {\n\t\tmessages: React.PropTypes.array.isRequired,\n\t\tsocket: React.PropTypes.object.isRequired,\n\t\tuser: React.PropTypes.object.isRequired\n\t},\n\n\tgetInitialState() {\n\t\treturn {\n\t\t\tautoScroll: true\n\t\t};\n\t},\n\n\tcomponentDidMount() {\n\t\tlet self = this;\n\n\t\tthis.scrollListener = _.debounce((event) => {\n\t\t\tself.temporarilyDisableAutoScroll(event);\n\t\t}, 300, {\n\t\t  leading: false,\n\t\t  trailing: true\n\t\t});\n\n\t\tlet node = ReactDOM.findDOMNode(this.refs.messageContainer);\n\t\tnode.addEventListener('scroll', this.scrollListener);\n\n\t\tthis.scrollToBottom();\n\t},\n\n\tcomponentWillUnmount() {\n\t\tnode.removeEventListener('scroll', this.scrollListener);\n\t\tclearTimeout(this.disableScrollTimer);\n\t},\n\n\tloadMoreMessages() {\n\t\tconst earliestMessage = this.props.messages[0];\n\t\tif (earliestMessage === undefined) return;\n\t\tthis.props.socket.emit(\"message:refresh\", {\n\t\t\tbefore: earliestMessage.createdAt\n\t\t});\n\t},\n\n\tsendMessage(message) {\n\t\tthis.props.socket.emit(\"newMessage\", {message: message});\n\t},\n\n\tclearAutoScrollTimeout() {\n\t\tif (this.disableScrollTimer) clearTimeout(this.disableScrollTimer);\n\t},\n\n\ttemporarilyDisableAutoScroll(event) {\n\t\tlet self = this;\n\t\tlet node = event.target;\n\t\tif (node) {\n\t\t\tif (node.scrollHeight - node.scrollTop === node.clientHeight) {\n\t\t\t\tthis.setState({ autoScroll: true });\n\t\t\t\tthis.clearAutoScrollTimeout();\n\t\t\t}\n\t\t\tif (node.scrollHeight - node.scrollTop - node.clientHeight < 50) return;\n\t\t}\n\t\tthis.setState({ autoScroll: false });\n\t\tthis.clearAutoScrollTimeout();\n\t\tthis.disableScrollTimer = setTimeout(() => {\n\t\t\tself.setState({\n\t\t\t\tautoScroll: true\n\t\t\t})\n\t\t}, 10000);\n\t},\n\n\tcomponentDidUpdate() {\n\t\tthis.scrollToBottom();\n\t},\n\n\tscrollToBottom() {\n\t\tif (!this.state.autoScroll) return;\n\t\tlet node = ReactDOM.findDOMNode(this.refs.messageContainer);\n\t  node.scrollTop = node.scrollHeight;\n\t},\n\n\trender() {\n\t\tconst socket = this.props.socket;\n\t\tconst messages = this.props.messages.map(message => {\n\t\t\tif (message) {\n\t\t\t\treturn <ChatMessage message={message} \n\t\t\t\t\t\t\t\t\tkey={message._id}\n\t\t\t\t\t\t\t\t\tsocket={socket}\n\t\t\t\t\t\t\t\t\tuser={this.props.user} />\n\t\t\t}\n\t\t});\n\t\treturn (\n\t\t\t<div className=\"panel panel-primary chatbox\">\n\t\t\t\t<div className=\"panel-heading\">Gather Chat</div>\n\t\t\t\t<div className=\"panel-body\">\n\t\t\t\t\t<ul className=\"chat\" id=\"chatmessages\" ref=\"messageContainer\">\n\t\t\t\t\t\t<li className=\"text-center\">\n\t\t\t\t\t\t\t<a href=\"#\"\n\t\t\t\t\t\t\t\tonClick={this.loadMoreMessages}\n\t\t\t\t\t\t\t\tclassName=\"btn btn-primary btn-xs\">\n\t\t\t\t\t\t\t\tLoad more messages\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t{messages}\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"panel-footer\">\n\t\t\t\t\t<MessageBar socket={socket}/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n});\n\nconst imgurRegex = /^(https?:\\/\\/i\\.imgur\\.com\\/\\S*\\.(jpg|png))$/i;\n\nconst ChatMessage = React.createClass({\n\tpropTypes: {\n\t\tuser: React.PropTypes.object.isRequired,\n\t\tsocket: React.PropTypes.object.isRequired,\n\t\tmessage: React.PropTypes.object.isRequired\n\t},\n\n\tmixins: [\n    ReactAutolink,\n    ReactEmoji\n  ],\n\n  getInitialState() {\n  \treturn {\n  \t\tcreatedAt: \"\"\n  \t}\n  },\n\n  updateCreatedAt() {\n  \tlet self = this;\n  \tif (this.props.message.createdAt) {\n  \t\tself.setState({\n  \t\t\tcreatedAt: $.timeago(self.props.message.createdAt)\n  \t\t})\n  \t}\n  },\n\n  componentWillMount() {\n\t\tthis.updateCreatedAt();\n  },\n\n\tcomponentDidMount() {\n\t\tthis.interval = setInterval(this.updateCreatedAt, 60000);\n\t},\n\n\tcomponentWillUnmount: function () {\n\t\tclearInterval(this.interval);\n\t},\n\n\tmessageContent: function () {\n\t\tlet self = this;\n\t\tlet message = self.props.message.content\n\t\tif (message.match(imgurRegex)) {\n\t\t\treturn (\n\t\t\t\t<div className=\"imgur-container\">\n\t\t\t\t\t<a href={message} target=\"_blank\">\n\t\t\t\t\t\t<img className=\"imgur-chat\" src={message} />\n\t\t\t\t\t</a>\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\n\t\treturn self.autolink(message, { \n\t\t\ttarget: \"_blank\", \n\t\t\trel: \"nofollow\" \n\t\t}).map((elem) => {\n\t\t\tif (_.isString(elem)) {\n\t\t\t\treturn self.emojify(elem);\n\t\t\t} else {\n\t\t\t\treturn elem;\n\t\t\t}\n\t\t});\n\t},\n\n\trender() {\n\t\tlet deleteButton;\n\t\tlet user = this.props.user;\n\t\tif (user && user.admin) {\n\t\t\tdeleteButton = <DeleteMessageButton messageId={this.props.message._id} \n\t\t\t\tsocket={this.props.socket}/>;\n\t\t}\n\t\treturn (\n\t\t\t<li className=\"left clearfix\">\n\t\t\t\t<span className=\"chat-img pull-left\">\n\t\t\t\t\t\t<img \n\t\t\t\t\t\t\tsrc={this.props.message.author.avatar} \n\t\t\t\t\t\t\talt=\"User Avatar\" \n\t\t\t\t\t\t\theight=\"40\"\n\t\t\t\t\t\t\twidth=\"40\"\n\t\t\t\t\t\t\tclassName=\"img-circle\" />\n\t\t\t\t</span>\n\t\t\t\t<div className=\"chat-body clearfix\">\n\t\t\t\t\t<div className=\"header\">\n\t\t\t\t\t\t<strong className=\"primary-font\">\n\t\t\t\t\t\t\t{this.props.message.author.username}\n\t\t\t\t\t\t\t</strong>\n\t\t\t\t\t\t<small className=\"pull-right text-muted\">\n\t\t\t\t\t\t\t{deleteButton}\n\t\t\t\t\t\t\t<span className=\"hidden-xs\">\n\t\t\t\t\t\t\t\t<i className=\"fa fa-clock-o fa-fw\"></i> \n\t\t\t\t\t\t\t\t{this.state.createdAt}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</small>\n\t\t\t\t\t</div>\n\t\t\t\t\t<p className=\"wordwrap\">{this.messageContent()}</p>\n\t\t\t\t</div>\n\t\t\t</li>\n\t\t);\n\t}\n});\n\nconst DeleteMessageButton = React.createClass({\n\tpropTypes: {\n\t\tsocket: React.PropTypes.object.isRequired\n\t},\n\n\thandleClick (e) {\n\t\te.preventDefault();\n\t\tthis.props.socket.emit(\"message:delete\", {\n\t\t\tid: this.props.messageId\n\t\t});\n\t},\n\n\trender() {\n\t\treturn (\n\t\t\t<a href=\"#\" onClick={this.handleClick}>\n\t\t\t\t<i className=\"fa fa-trash-o\"></i>\n\t\t\t</a>\n\t\t);\n\t}\n})\n\nconst MessageBar = React.createClass({\n\tpropTypes: {\n\t\tsocket: React.PropTypes.object.isRequired\n\t},\n\n\tsendMessage(content) {\n\t\tthis.props.socket.emit(\"message:new\", {\n\t\t\tcontent: content\n\t\t});\n\t},\n\n\tgetInitialState() {\n\t\treturn {\n\t\t\tstatusMessage: null\n\t\t};\n\t},\n\n\tcheckInputLength() {\n\t\tconst input = ReactDOM.findDOMNode(this.refs.content).value;\n\t\tconst currentStatusMessage = this.state.statusMessage;\n\t\tif (input.length > 256) {\n\t\t\treturn this.setState({\n\t\t\t\tstatusMessage: \"Maximum of 256 characters will be saved\"\n\t\t\t})\n\t\t}\n\t\tif (currentStatusMessage !== null) {\n\t\t\tthis.setState({\n\t\t\t\tstatusMessage: null\n\t\t\t});\n\t\t}\n\t},\n\n\thandleInputChange() {\n\t\t// Noop, later assigned as debounced method in componentWillMount\n\t},\n\n\thandleSubmit(e) {\n\t\te.preventDefault();\n\t\tlet content = ReactDOM.findDOMNode(this.refs.content).value.trim();\n\t\tif (!content) return;\n\t\tReactDOM.findDOMNode(this.refs.content).value = '';\n\t\tthis.sendMessage(content);\n\t\treturn;\n\t},\n\n\tcomponentWillMount() {\n\t\tthis.handleInputChange = _.debounce(this.checkInputLength, {\n\t\t\tleading: false,\n\t\t\ttrailing: true\n\t\t});\n\t},\n\n\trender() {\n\t\tlet statusMessage;\n\t\tif (this.state.statusMessage !== null) {\n\t\t\tstatusMessage = <div className=\"input-group\">\n\t\t\t\t<small>{this.state.statusMessage}</small>\n\t\t\t</div>;\n\t\t}\n\t\treturn (\n\t\t\t<form onSubmit={this.handleSubmit} autoComplete=\"off\">\n\t\t\t\t<div className=\"input-group\">\n\t\t\t\t\t<input \n\t\t\t\t\t\tid=\"btn-input\" \n\t\t\t\t\t\ttype=\"text\" \n\t\t\t\t\t\tclassName=\"form-control\" \n\t\t\t\t\t\tref=\"content\"\n\t\t\t\t\t\tonChange={this.handleInputChange}\n\t\t\t\t\t\tautoComplete=\"off\"\n\t\t\t\t\t\tplaceholder=\"Be polite please...\" />\n\t\t\t\t\t<span className=\"input-group-btn\">\n\t\t\t\t\t\t<input \n\t\t\t\t\t\t\ttype=\"submit\" \n\t\t\t\t\t\t\tclassName=\"btn btn-primary\" \n\t\t\t\t\t\t\tid=\"btn-chat\" \n\t\t\t\t\t\t\tvalue=\"Send\" />\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t{statusMessage}\n\t\t\t</form>\n\t\t);\n\t}\n});\n","const React = require(\"react\");\n\nconst SettingsPanel = exports.SettingsPanel = React.createClass({\n\tpropTypes: {\n\t\ttoggleUpdateTitle: React.PropTypes.func.isRequired,\n\t\tupdateTitle: React.PropTypes.bool.isRequired,\n\t\ttoggleEventsPanel: React.PropTypes.func.isRequired,\n\t\tshowEventsPanel: React.PropTypes.bool.isRequired\n\t},\n\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"modal fade\" id=\"settingsmodal\">\n\t\t\t\t<div className=\"modal-dialog\">\n\t\t\t\t\t<div className=\"modal-content\">\n\t\t\t\t\t\t<div className=\"modal-header\">\n\t\t\t\t\t\t\t<button type=\"button\" className=\"close\" data-dismiss=\"modal\" \n\t\t\t\t\t\t\t\taria-label=\"Close\">\n\t\t\t\t\t\t\t\t\t<span aria-hidden=\"true\">&times;</span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<h4 className=\"modal-title\">Settings</h4>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"modal-body\">\n\t\t\t\t\t\t\t<div className=\"checkbox\">\n\t\t\t\t\t\t\t\t<label className=\"checkbox-inline\">\n\t\t\t\t\t\t\t\t\t<input type=\"checkbox\" \n\t\t\t\t\t\t\t\t\t\tonChange={this.props.toggleUpdateTitle}\n\t\t\t\t\t\t\t\t\t\tchecked={this.props.updateTitle}/> Update Gather Status in Title (Cabooble Mode) - May require refresh\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</div>\n\t\t        </div>\n\t\t        <div className=\"modal-body\">\n\t\t\t\t\t\t\t<div className=\"checkbox\">\n\t\t\t\t\t\t\t\t<label className=\"checkbox-inline\">\n\t\t\t\t\t\t\t\t\t<input type=\"checkbox\" \n\t\t\t\t\t\t\t\t\t\tonChange={this.props.toggleEventsPanel}\n\t\t\t\t\t\t\t\t\t\tchecked={this.props.showEventsPanel}/> Show events panel\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</div>\n\t\t        </div>\n\t\t\t\t\t\t<div className=\"modal-footer\">\n\t\t\t\t\t\t\t<button type=\"button\" className=\"btn btn-default\" \n\t\t\t\t\t\t\t\tdata-dismiss=\"modal\">Close</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n});\n","const React = require(\"react\");\n\nvar SnowMachineMenu = React.createClass({\n\tgetInitialState() {\n\t\treturn {\n\t\t\tsnowMachine: null\n\t\t}\n\t},\n\n\tcomponentDidMount() {\n\t\tconst snowMachine = new SnowMachine();\n\t\tsnowMachine.start();\n\t\tthis.setState({ snowMachine: snowMachine });\n\t},\n\n\ttoggle() {\n\t\tconst snowMachine = this.state.snowMachine;\n\t\tif (snowMachine.timer) {\n\t\t\tsnowMachine.stop();\n\t\t} else {\n\t\t\tsnowMachine.start();\n\t\t}\n\t},\n\n\trender() {\n\t\treturn (\n\t\t\t<ul className=\"nav navbar-top-links navbar-right\">\n\t\t\t  <li>\n\t\t\t\t\t<a href=\"#\" onClick={this.toggle}>\n\t\t\t\t\t\tSnow\n\t\t\t\t\t</a>\n\t\t\t\t</li>\n\t\t  </ul>\n\t  );\n\t}\n});\n","const $ = require(\"jquery\");\nconst React = require(\"react\");\nconst Howl = require(\"howler\").Howl;\nconst Howler = require(\"howler\").Howler;\nconst helper = require(\"javascripts/helper\");\nconst storageAvailable = helper.storageAvailable;\n\nclass SoundController {\n\tconstructor () {\n\t\tif (Howl === undefined) {\n\t\t\tthrow new Error(\"Howl.js required to created sound controller\");\n\t\t}\n\n\t\tthis.MINIMUM_PLAY_INTERVAL = 20000;\n\n\t\tthis.playGatherMusic = _.throttle(() => {\n\t\t\tthis.gather.music.play();\n\t\t}, this.MINIMUM_PLAY_INTERVAL);\n\n\t\tthis.isMuted = Howler._muted;\n\t\t\n\t\tlet gatherMusic;\n\t\tif (storageAvailable(\"localStorage\")) {\n\t\t\tlet volume = localStorage.getItem(\"gatherVolume\");\n\t\t\tif (volume !== undefined) Howler.volume(volume);\n\t\t\tgatherMusic = localStorage.getItem(\"gatherMusic\");\n\t\t}\n\n\t\tthis.tunes = {\n\t\t\t\"classic\": {\n\t\t\t\tdescription: \"Gathers Classic\",\n\t\t\t\turl: 'http://www.ensl.org/files/audio/gather-1.mp3'\n\t\t\t},\n\t\t\t\"nights\": {\n\t\t\t\tdescription: \"Nights\",\n\t\t\t\turl: 'http://www.ensl.org/files/audio/nights.mp3'\n\t\t\t},\n\t\t\t\"robby\": {\n\t\t\t\tdescription: \"Robby\",\n\t\t\t\turl: 'http://www.ensl.org/files/audio/robby.mp3'\n\t\t\t},\n\t\t\t\"america\": {\n\t\t\t\tdescription: \"Infamous\",\n\t\t\t\turl: 'http://www.ensl.org/files/audio/america.mp3'\n\t\t\t},\n\t\t\t\"prommah\": {\n\t\t\t\tdescription: \"Prommah\",\n\t\t\t\turl: 'http://www.ensl.org/files/audio/prommah.mp3'\n\t\t\t},\n\t\t\t\"turts\": {\n\t\t\t\tdescription: \"Gorges Rock your Ass\",\n\t\t\t\turl: 'http://www.ensl.org/files/audio/turts.mp3'\n\t\t\t},\n\t\t\t\"skyice\": {\n\t\t\t\tdescription: \"Skyice\",\n\t\t\t\turl: 'http://www.ensl.org/files/audio/skyice.mp3'\n\t\t\t},\n\t\t\t\"justwannahavefun\": {\n\t\t\t\tdescription: \"Gorges just want to have fun\",\n\t\t\t\turl: 'http://www.ensl.org/files/audio/justwannahavefun.mp3'\n\t\t\t},\n\t\t\t\"eyeofthegorgie\": {\n\t\t\t\tdescription: \"Eye of the Gorgie\",\n\t\t\t\turl: 'http://www.ensl.org/files/audio/eyeofthegorgie.mp3'\n\t\t\t},\n\t\t\t\"boondock\": {\n\t\t\t\tdescription: \"Boondock Marines\",\n\t\t\t\turl: 'http://www.ensl.org/files/audio/boondock.mp3'\n\t\t\t},\n\t\t\t\"preclassic\": {\n\t\t\t\tdescription: \"Old Gathers Classic\",\n\t\t\t\turl: 'http://www.ensl.org/files/audio/gather-5.mp3'\n\t\t\t}\n\t\t}\n\n\t\tthis.setupGatherMusic(gatherMusic);\n\t}\n\n\tmute() {\n\t\tthis.isMuted = true;\n\t\treturn Howler.mute();\n\t}\n\n\tunMute() {\n\t\tthis.isMuted = false;\n\t\treturn Howler.unmute();\n\t}\n\n\tgetVolume() {\n\t\treturn Howler.volume();\n\t}\n\n\tsetVolume(val) {\n\t\tif (val === undefined || \n\t\t\t\ttypeof val !== 'number' || \n\t\t\t\tMath.abs(val) > 1) return;\n\t\tif (storageAvailable(\"localStorage\")) {\n\t\t\tlocalStorage.setItem(\"gatherVolume\", val);\n\t\t}\n\t\treturn Howler.volume(val);\n\t}\n\n\tplay(music) {\n\t\tif (this.gather && this.gather.music) return this.gather.music.play();\n\t}\n\n\tstop(music) {\n\t\tif (this.gather && this.gather.music) return this.gather.music.stop();\n\t}\n\n\tdefaultGatherMusic() {\n\t\treturn \"classic\";\n\t}\n\n\tsetupGatherMusic (musicName) {\n\t\tlet self = this;\n\t\tlet gatherMusic = self.tunes[musicName];\n\n\t\tif (!gatherMusic) {\n\t\t\tmusicName = this.defaultGatherMusic();\n\t\t\tgatherMusic = self.tunes[musicName]; \n\t\t}\n\n\t\tif (self.gather && self.gather.name === musicName) return;\n\n\t\t// Stop if already playing\n\t\tif (self.gather && self.gather.music) {\n\t\t\tself.gather.music.stop();\n\t\t}\n\n\t\tlet tune = self.tunes[musicName];\n\t\tself.gather = {\n\t\t\tname: musicName,\n\t\t\tdescription: tune.description,\n\t\t\turl: tune.url,\n\t\t\tmusic: new Howl({\n\t\t\t\turls: [tune.url]\n\t\t\t})\n\t\t};\n\t}\n}\n\nvar MusicSelector = React.createClass({\n\tgetInitialState() {\n\t\treturn {\n\t\t\tmusic: this.selectedMusic()\n\t\t}\n\t},\n\n\tselectedMusic() {\n\t\tif (storageAvailable(\"localStorage\")) {\n\t\t\treturn localStorage.getItem(\"gatherMusic\") \n\t\t\t\t|| this.props.soundController.defaultGatherMusic();\n\t\t} else {\n\t\t\treturn this.props.soundController.defaultGatherMusic(); \n\t\t}\n\t},\n\n\tsetMusic(event) {\n\t\tlet name = event.target.value;\n\t\tlet soundController = this.props.soundController;\n\t\tlet selectedTune = soundController.tunes[name];\n\t\tif (selectedTune === undefined) return;\n\t\tthis.setState({ music: name });\n\t\tsoundController.setupGatherMusic(name);\n\t\tif (storageAvailable(\"localStorage\")) {\n\t\t\tlocalStorage.setItem(\"gatherMusic\", name);\n\t\t}\n\t},\n\n\trender() {\n\t\tlet soundController = this.props.soundController;\n\t\tlet tunes = [];\n\t\tfor (var attr in soundController.tunes) {\n\t\t\tlet o = soundController.tunes[attr];\n\t\t\to.id = attr;\n\t\t\ttunes.push(o);\n\t\t}\n\t\tlet options = tunes.map(tune => {\n\t\t\treturn <option key={tune.id} value={tune.id}>{tune.description}</option>;\n\t\t});\n\t\treturn (\n\t\t\t<div className=\"form-group music-select\">\n\t\t\t\t<label>Music</label>\n\t\t\t\t<select\n\t\t\t\t\tclassName=\"form-control\"\n\t\t\t\t\tdefaultValue={this.state.music}\n\t\t\t\t\tonChange={this.setMusic}\n\t\t\t\t\tvalue={this.state.music}>\n\t\t\t\t\t{options}\n\t\t\t\t</select>\n\t\t\t</div>\n\t\t);\n\t}\n})\n\nvar SoundPanel = React.createClass({\n\tcomponentDidMount() {\n\t\tlet soundController = this.props.soundController;\n\t\tlet scale = 10;\n\n\t\t$('a#sound-dropdown').on('click', function (event) {\n\t\t\t$(this).parent().toggleClass('open');\n\t\t});\n\n\t\t$(\"#volume-slide\").slider({\n\t\t\tmin: 0,\n\t\t\tmax: scale,\n\t\t\tstep: 1\n\t\t}).on(\"slideStop\", ({value}) => {\n\t\t\tsoundController.setVolume(value / scale);\n\t\t}).slider('setValue', soundController.getVolume() * scale);\n\t},\n\n\tmute() {\n\t\tthis.props.soundController.mute();\n\t\tthis.forceUpdate();\n\t},\n\n\tunMute() {\n\t\tthis.props.soundController.unMute();\n\t\tthis.forceUpdate();\n\t},\n\n\tplay() {\n\t\tthis.props.soundController.play();\n\t},\n\n\tstop() {\n\t\tthis.props.soundController.stop();\n\t},\n\n\trender() {\n\t\tlet soundController = this.props.soundController;\n\t\tlet mutedIcon, mutedButton;\n\t\tif (soundController.isMuted) {\n\t\t\tmutedIcon = <i className=\"fa fa-volume-off fa-fw\"></i>;\n\t\t\tmutedButton = <li>\n\t\t\t\t<a href=\"#\" onClick={this.unMute}>\n\t\t\t\t\t{mutedIcon}&nbsp;Muted\n\t\t\t\t</a>\n\t\t\t</li>;\n\t\t} else {\n\t\t\tmutedIcon = <i className=\"fa fa-volume-up fa-fw\"></i>;\n\t\t\tmutedButton = <li>\n\t\t\t\t<a href=\"#\" onClick={this.mute}>\n\t\t\t\t\t{mutedIcon}&nbsp;Unmuted\n\t\t\t\t</a>\n\t\t\t</li>;\n\t\t}\n\t\treturn <ul className=\"nav navbar-top-links navbar-right\">\n\t\t  <li className=\"dropdown\">\n\t\t\t\t<a className=\"dropdown-toggle\" href=\"#\" id=\"sound-dropdown\">\n\t\t\t\t\tSound &nbsp;{mutedIcon}&nbsp;<i className=\"fa fa-caret-down\"></i>\n\t\t\t\t</a>\n\t\t\t\t<ul className=\"dropdown-menu\" id=\"sound-dropdown\">\n\t\t\t\t\t{mutedButton}\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<a href='#' onClick={this.play}>\n\t\t\t\t\t\t\t<i className=\"fa fa-play\"></i>&nbsp;Play\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<a href='#' onClick={this.stop}>\n\t\t\t\t\t\t\t<i className=\"fa fa-stop\"></i>&nbsp;Stop\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</li>\n\t\t\t\t\t<hr />\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div className=\"volume-slide\">\n\t\t\t\t\t\t\t<label>Volume</label>\n\t\t\t\t\t\t\t<div id=\"volume-slide\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<MusicSelector soundController={soundController} />\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t</li>\n\t  </ul>;\n\t}\n});\n\nmodule.exports = {\n\tSoundController: SoundController,\n\tSoundPanel: SoundPanel\n};\n","const React = require(\"react\");\n\nconst teamspeakDefaults = {\n\turl: \"ts3server://ensl.org/\",\n\tpassword: \"ns2gather\",\n\talien: {\n\t\tchannel: \"NS2 Gather/Gather #1/Alien\",\n\t\tpassword: \"ns2gather\"\n\t},\n\tmarine: {\n\t\tchannel: \"NS2 Gather/Gather #1/Marine\",\n\t\tpassword: \"ns2gather\"\n\t}\n};\n\nvar TeamSpeakButton = exports.TeamSpeakButton = React.createClass({\n\tgetDefaultProps() {\n\t\treturn teamspeakDefaults\n\t},\n\tmarineUrl() {\n\t\treturn this.teamSpeakUrl(this.props.marine);\n\t},\n\talienUrl() {\n\t\treturn this.teamSpeakUrl(this.props.alien);\n\t},\n\tteamSpeakUrl(conn) {\n\t\tlet params = `channel=${encodeURIComponent(conn.channel)}&\n\t\t\tchannelpassword=${encodeURIComponent(conn.password)}`;\n\t\treturn (`${this.props.url}?${params}`);\n\t},\n\trender() {\n\t\treturn (\n\t\t\t<ul className=\"nav navbar-top-links navbar-right\">\n\t\t\t  <li className=\"dropdown\">\n\t\t\t\t\t<a className=\"dropdown-toggle\" data-toggle=\"dropdown\" href=\"#\">\n\t\t\t\t\t\tTeamspeak &nbsp;<i className=\"fa fa-caret-down\"></i>\n\t\t\t\t\t</a>\n\t\t\t\t\t<ul className=\"dropdown-menu\">\n\t\t\t\t\t\t<li><a href={this.props.url}>Join Teamspeak Lobby</a></li>\n\t\t\t\t\t\t<li><a href={this.marineUrl()}>Join Marine Teamspeak</a></li>\n\t\t\t\t\t\t<li><a href={this.alienUrl()}>Join Alien Teamspeak</a></li>\n\t\t\t\t\t\t<li role=\"separator\" className=\"divider\"></li>\n\t\t\t\t\t\t<li><a href=\"#\" data-toggle=\"modal\" data-target=\"#teamspeakmodal\">Teamspeak Details</a></li>\n\t\t\t\t\t</ul>\n\t\t\t\t</li>\n\t\t  </ul>\n\t\t);\n\t}\n});\n\nvar TeamSpeakModal = exports.TeamSpeakModal = React.createClass({\n\tgetDefaultProps() {\n\t\treturn teamspeakDefaults;\n\t},\n\n\trender() {\n\t\treturn <div className=\"modal fade text-left\" id=\"teamspeakmodal\">\n\t\t\t<div className=\"modal-dialog\">\n\t\t\t\t<div className=\"modal-content\">\n\t\t\t\t\t<div className=\"modal-header\">\n\t\t\t\t\t\t<button type=\"button\" \n\t\t\t\t\t\t\tclassName=\"close\" \n\t\t\t\t\t\t\tdata-dismiss=\"modal\" \n\t\t\t\t\t\t\taria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>\n\t\t\t\t\t\t<h4 className=\"modal-title\">Teamspeak Server Information</h4>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"modal-body\">\n\t\t\t\t\t\t<dl className=\"dl-horizontal\">\n\t\t\t\t\t\t\t<dt>Server</dt>\n\t\t\t\t\t\t\t<dd>{this.props.url}</dd>\n\t\t\t\t\t\t\t<dt>Password</dt>\n\t\t\t\t\t\t\t<dd>{this.props.password}</dd>\n\t\t\t\t\t\t\t<dt>Marine Channel</dt>\n\t\t\t\t\t\t\t<dd>{this.props.marine.channel}</dd>\n\t\t\t\t\t\t\t<dt>Alien Channel</dt>\n\t\t\t\t\t\t\t<dd>{this.props.alien.channel}</dd>\n\t\t\t\t\t\t</dl>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t}\n});\n","import {LifeformIcons} from \"javascripts/components/gather\";\nconst React = require(\"react\");\nconst helper = require(\"javascripts/helper\");\nconst enslUrl = helper.enslUrl;\nconst hiveUrl = helper.hiveUrl;\nconst modalId = helper.modalId;\n\nconst UserLogin = React.createClass({\n\tpropTypes: {\n\t\tsocket: React.PropTypes.object.isRequired\n\t},\n\n\tauthorizeId(id) {\n\t\tthis.props.socket.emit(\"users:authorize\", {\n\t\t\tid: parseInt(id, 10)\n\t\t});\n\t},\n\n\thandleSubmit(e) {\n\t\te.preventDefault();\n\t\tlet id = React.findDOMNode(this.refs.authorize_id).value.trim();\n\t\tif (!id) return;\n\t\tReact.findDOMNode(this.refs.authorize_id).value = '';\n\t\tthis.authorizeId(id);\n\t},\n\n\trender() {\n\t\treturn (\n\t\t\t<form onSubmit={this.handleSubmit} >\n\t\t\t\t<div className=\"input-group signin\">\n\t\t\t\t\t<input \n\t\t\t\t\t\tid=\"btn-input\" \n\t\t\t\t\t\ttype=\"text\" \n\t\t\t\t\t\tclassName=\"form-control\" \n\t\t\t\t\t\tref=\"authorize_id\"\n\t\t\t\t\t\tplaceholder=\"Change user\" />\n\t\t\t\t\t<span className=\"input-group-btn\">\n\t\t\t\t\t\t<input \n\t\t\t\t\t\t\ttype=\"submit\" \n\t\t\t\t\t\t\tclassName=\"btn btn-primary\" \n\t\t\t\t\t\t\tid=\"btn-chat\" \n\t\t\t\t\t\t\tvalue=\"Assume ID\" />\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t);\n\t}\n});\n\nconst DisconnectUserButton = React.createClass({\n\tpropTypes: {\n\t\tsocket: React.PropTypes.object.isRequired,\n\t\tid: React.PropTypes.number.isRequired\n\t},\n\n\tgetDefaultProps() {\n\t\treturn {\n\t\t\tid: null\n\t\t};\n\t},\n\n\tdisconnectUser() {\n\t\tthis.props.socket.emit(\"users:disconnect\", {\n\t\t\tid: this.props.id\n\t\t});\n\t},\n\t\n\trender() {\n\t\treturn <button\n\t\t\tclassName=\"btn btn-danger\"\n\t\t\tonClick={this.disconnectUser}>\n\t\t\tDisconnect User</button>\n\t}\n});\n\nconst UserModal = React.createClass({\n\tpropTypes: {\n\t\tuser: React.PropTypes.object.isRequired,\n\t\tsocket: React.PropTypes.object.isRequired,\n\t\tcurrentUser: React.PropTypes.object.isRequired\n\t},\n\n\trender() {\n\t\tconst currentUser = this.props.currentUser;\n\t\tconst user = this.props.user;\n\t\tlet hiveStats;\n\t\tif (user.hive.id) {\n\t\t\thiveStats = [\n\t\t\t<tr key=\"stats\"><td><strong>Hive Stats</strong></td><td></td></tr>,\n\t\t\t<tr key=\"elo\">\n\t\t\t\t<td>ELO</td>\n\t\t\t\t<td>{user.hive.skill}</td>\n\t\t\t</tr>,\n\t\t\t<tr key=\"hours\">\n\t\t\t\t<td>Hours Played</td>\n\t\t\t\t<td>{Math.round(user.hive.playTime / 3600)}</td>\n\t\t\t</tr>,\n\t\t\t<tr key=\"wins\">\n\t\t\t\t<td>Wins</td>\n\t\t\t\t<td>{user.hive.wins}</td>\n\t\t\t</tr>,\n\t\t\t<tr key=\"losses\">\n\t\t\t\t<td>Losses</td>\n\t\t\t\t<td>{user.hive.loses}</td>\n\t\t\t</tr>,\n\t\t\t<tr key=\"kills\">\n\t\t\t\t<td>Kills (/min)</td>\n\t\t\t\t<td>{user.hive.kills} ({_.round(user.hive.kills / (user.hive.playTime / 60), 1)})</td>\n\t\t\t</tr>,\n\t\t\t<tr key=\"assists\">\n\t\t\t\t<td>Assists (/min)</td>\n\t\t\t\t<td>{user.hive.assists} ({_.round(user.hive.assists / (user.hive.playTime / 60), 1)})</td>\n\t\t\t</tr>,\n\t\t\t<tr key=\"deaths\">\n\t\t\t\t<td>Deaths (/min)</td>\n\t\t\t\t<td>{user.hive.deaths} ({_.round(user.hive.deaths / (user.hive.playTime / 60), 1)})</td>\n\t\t\t</tr>\n\t\t\t]\n\t\t}\n\t\tlet adminOptions;\n\t\tif (currentUser.admin) {\n\t\t\tadminOptions = <DisconnectUserButton id={user.id} socket={this.props.socket} />;\n\t\t}\n\t\treturn (\n\t\t\t<div className=\"modal fade\" id={modalId(user)}>\n\t\t\t\t<div className=\"modal-dialog\">\n\t\t\t\t\t<div className=\"modal-content\">\n\t\t\t\t\t\t<div className=\"modal-header\">\n\t\t\t\t\t\t\t<button type=\"button\" className=\"close\" data-dismiss=\"modal\" \n\t\t\t\t\t\t\t\taria-label=\"Close\">\n\t\t\t\t\t\t\t\t\t<span aria-hidden=\"true\">&times;</span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<h4 className=\"modal-title\">\n\t\t\t\t\t\t\t\t<img src=\"blank.gif\" \n\t\t\t\t\t\t\t\t\tclassName={\"flag flag-\" + ((user.country === null) ? \"eu\" : \n\t\t\t\t\t\t\t\t\t\tuser.country.toLowerCase()) } \n\t\t\t\t\t\t\t\t\talt={user.country} />&nbsp;\n\t\t\t\t\t\t\t\t{user.username}\n\t\t\t\t\t\t\t</h4>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"modal-body\">\n\t\t\t\t\t\t\t<div className=\"text-center\">\n\t\t\t\t\t\t\t\t<img \n\t\t\t\t\t\t\t\tsrc={user.avatar} \n\t\t\t\t\t\t\t\talt=\"User Avatar\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<table className=\"table\">\n\t\t\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>Lifeforms</td>\n\t\t\t\t\t\t\t\t\t\t<td><LifeformIcons gatherer={{user: user}} /></td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>Links</td>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<a href={enslUrl(user)} \n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"btn btn-xs btn-primary\"\n\t\t\t\t\t\t\t\t\t\t\t\ttarget=\"_blank\">ENSL Profile</a>&nbsp;\n\t\t\t\t\t\t\t\t\t\t\t<a href={hiveUrl({user: user})} \n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"btn btn-xs btn-primary\"\n\t\t\t\t\t\t\t\t\t\t\t\ttarget=\"_blank\">Hive Profile</a>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t{hiveStats}\n\t\t\t\t\t\t\t\t</tbody>\n\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"modal-footer\">\n\t\t\t\t\t\t\t{adminOptions}\n\t\t\t\t\t\t\t<button type=\"button\" \n\t\t\t\t\t\t\t\tclassName=\"btn btn-default\" \n\t\t\t\t\t\t\t\tdata-dismiss=\"modal\">Close</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n})\n\nconst UserItem = React.createClass({\n\tpropTypes: {\n\t\tuser: React.PropTypes.object.isRequired,\n\t\tsocket: React.PropTypes.object.isRequired,\n\t\tcurrentUser: React.PropTypes.object.isRequired\n\t},\n\n\trender() {\n\t\tconst user = this.props.user;\n\t\tconst currentUser = this.props.currentUser;\n\t\treturn (\n\t\t\t<li className=\"list-group-item\">\n\t\t\t\t<a href=\"#\" data-toggle=\"modal\" \n\t\t\t\tdata-target={`#${modalId(user)}`}>{user.username}</a>\n\t\t\t\t<UserModal user={user} currentUser={currentUser} \n\t\t\t\t\tsocket={this.props.socket} />\n\t\t\t</li>\n\t\t);\n\t}\n});\n\nconst UserMenu = exports.UserMenu = React.createClass({\n\tpropTypes: {\n\t\tsocket: React.PropTypes.object.isRequired,\n\t\tusers: React.PropTypes.array.isRequired\n\t},\n\n\trender() {\n\t\tconst users = this.props.users\n\t\t.sort((a, b) => (a.username.toLowerCase() > b.username.toLowerCase()) ? 1 : -1)\n\t\t.map(user => {\n\t\t\treturn <UserItem user={user} key={user.id} \n\t\t\t\tcurrentUser={this.props.user} socket={this.props.socket} />\n\t\t});\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<div className=\"panel panel-primary add-bottom\">\n\t\t\t\t\t<div className=\"panel-heading\">\n\t\t\t\t\t\t<i className=\"fa fa-users fa-fw\"></i>  Online\n\t\t\t\t\t\t<span className=\"badge pull-right\">{this.props.users.length}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<ul className=\"list-group\" id=\"users-list\">\n\t\t\t\t\t\t{users}\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n});\n\nconst AdminPanel = exports.AdminPanel = React.createClass({\n\tpropTypes: {\n\t\tsocket: React.PropTypes.object.isRequired\n\t},\n\n\thandleGatherReset() {\n\t\tthis.props.socket.emit(\"gather:reset\");\n\t},\n\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"modal fade\" id=\"adminmodal\">\n\t\t\t\t<div className=\"modal-dialog\">\n\t\t\t\t\t<div className=\"modal-content\">\n\t\t\t\t\t\t<div className=\"modal-header\">\n\t\t\t\t\t\t\t<button type=\"button\" className=\"close\" data-dismiss=\"modal\" \n\t\t\t\t\t\t\t\taria-label=\"Close\">\n\t\t\t\t\t\t\t\t\t<span aria-hidden=\"true\">&times;</span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<h4 className=\"modal-title\">Administration Panel</h4>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"modal-body\" id=\"admin-menu\">\n\t\t\t\t\t\t\t<h5>Swap Into a Different Account (Only works for admins)</h5>\n\t\t\t\t\t\t\t<UserLogin socket={this.props.socket} />\n\t\t\t\t\t\t\t<h5>Gather Options</h5>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclassName=\"btn btn-danger max-width\"\n\t\t\t\t\t\t\t\t\tonClick={this.handleGatherReset}>\n\t\t\t\t\t\t\t\t\tReset Gather</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"modal-footer\">\n\t\t\t\t\t\t\t<button type=\"button\" className=\"btn btn-default\" \n\t\t\t\t\t\t\t\tdata-dismiss=\"modal\">Close</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n});\n\nconst ProfileModal = exports.ProfileModal = React.createClass({\n\tpropTypes: {\n\t\tuser: React.PropTypes.object.isRequired\n\t},\n\n\thandleUserUpdate(e) {\n\t\te.preventDefault();\n\t\tlet abilities = {\n\t\t\tskulk: React.findDOMNode(this.refs.skulk).checked,\n\t\t\tlerk: React.findDOMNode(this.refs.lerk).checked,\n\t\t\tgorge: React.findDOMNode(this.refs.gorge).checked,\n\t\t\tfade: React.findDOMNode(this.refs.fade).checked,\n\t\t\tonos: React.findDOMNode(this.refs.onos).checked,\n\t\t\tcommander: React.findDOMNode(this.refs.commander).checked\n\t\t};\n\t\tlet skill = React.findDOMNode(this.refs.playerskill).value;\n\t\tsocket.emit(\"users:update:profile\", {\n\t\t\tid: this.props.user.id,\n\t\t\tprofile: {\n\t\t\t\tabilities: abilities,\n\t\t\t\tskill: skill\n\t\t\t}\n\t\t});\n\t},\n\n\trender() {\n\t\tif (!this.props.user) return false;\n\t\tlet abilities = this.props.user.profile.abilities;\n\t\tlet abilitiesForm = [];\n\t\tfor (let lifeform in abilities) {\n\t\t\tabilitiesForm.push(\n\t\t\t\t<div key={lifeform} className=\"checkbox\">\n\t\t\t\t\t<label className=\"checkbox-inline\">\n\t\t\t\t\t\t<input type=\"checkbox\" \n\t\t\t\t\t\t\tref={lifeform}\n\t\t\t\t\t\t\tdefaultChecked={abilities[lifeform]}/> {_.capitalize(lifeform)}\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\n\t\tlet skillLevel = this.props.user.profile.skill;\n\t\tlet skillLevels = _.uniq([\"Low Skill\", \"Medium Skill\", \"High Skill\", skillLevel])\n\t\t\t.filter(skill => { return typeof skill === 'string' })\n\t\t\t.map(skill => { return <option key={skill}>{skill}</option>});\n\n\t\treturn (\n\t\t\t<div className=\"modal fade\" id=\"profilemodal\">\n\t\t\t\t<div className=\"modal-dialog\">\n\t\t\t\t\t<div className=\"modal-content\">\n\t\t\t\t\t\t<div className=\"modal-header\">\n\t\t\t\t\t\t\t<button type=\"button\" className=\"close\" data-dismiss=\"modal\" \n\t\t\t\t\t\t\t\taria-label=\"Close\">\n\t\t\t\t\t\t\t\t<span aria-hidden=\"true\">&times;</span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<h4 className=\"modal-title\">Profile</h4>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"modal-body\" id=\"profile-panel\">\n\t\t\t\t\t\t\t<form>\n\t\t\t\t\t\t\t\t<div className=\"form-group\">\n\t\t\t\t\t\t\t\t\t<label>Player Skill</label><br />\n\t\t\t\t\t\t\t\t\t<select \n\t\t\t\t\t\t\t\t\t\tdefaultValue={skillLevel}\n\t\t\t\t\t\t\t\t\t\tclassName=\"form-control\" \n\t\t\t\t\t\t\t\t\t\tref=\"playerskill\">\n\t\t\t\t\t\t\t\t\t\t{skillLevels}\n\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t<p className=\"add-top\"><small>\n\t\t\t\t\t\t\t\t\t\tTry to give an accurate representation of your skill to raise \n\t\t\t\t\t\t\t\t\t\t\tthe quality of your gathers\n\t\t\t\t\t\t\t\t\t</small></p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<hr />\n\t\t\t\t\t\t\t\t<div className=\"form-group\">\n\t\t\t\t\t\t\t\t\t<label>Preferred Lifeforms</label><br />\n\t\t\t\t\t\t\t\t\t{abilitiesForm}\n\t\t\t\t\t\t\t\t\t<p><small>\n\t\t\t\t\t\t\t\t\t\tSpecify which lifeforms you'd like to play in the gather\n\t\t\t\t\t\t\t\t\t</small></p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<hr />\n\t\t\t\t\t\t\t\t<p className=\"small\">\n\t\t\t\t\t\t\t\t\tYou will need to rejoin the gather to see your updated profile\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t<div className=\"form-group\">\n\t\t\t\t\t\t\t\t\t<button \n\t\t\t\t\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t\t\t\t\t\tclassName=\"btn btn-primary\"\n\t\t\t\t\t\t\t\t\t\tdata-dismiss=\"modal\"\n\t\t\t\t\t\t\t\t\t\tonClick={this.handleUserUpdate}>\n\t\t\t\t\t\t\t\t\t\tUpdate &amp; Close</button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</form>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n});\n\nconst CurrentUser = exports.CurrentUser = React.createClass({\n\trender() {\n\t\tif (this.props.user) {\n\t\t\tlet adminOptions;\n\t\t\tif (this.props.user.admin || this.props.user.moderator) {\n\t\t\t\tadminOptions = (\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<a href=\"#\" data-toggle=\"modal\" data-target=\"#adminmodal\">\n\t\t\t\t\t\t\t<i className=\"fa fa-magic fa-fw\"></i> Administration\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</li>\n\t\t\t\t)\n\t\t\t}\n\t\t\treturn (\n\t\t\t\t<li className=\"dropdown\">\n\t\t\t\t\t<a className=\"dropdown-toggle\" data-toggle=\"dropdown\" href=\"#\">\n\t\t\t\t\t\t{this.props.user.username} &nbsp;<img src={this.props.user.avatar}\n\t\t\t\t\t\talt=\"User Avatar\" \n\t\t\t\t\t\theight=\"20\"\n\t\t\t\t\t\twidth=\"20\" /> <i className=\"fa fa-caret-down\"></i>\n\t\t\t\t\t</a>\n\t\t\t\t\t<ul className=\"dropdown-menu dropdown-user\">\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<a data-toggle=\"modal\" \n\t\t\t\t\t\t\t\tdata-target=\"#profilemodal\" \n\t\t\t\t\t\t\t\thref=\"#\"><i className=\"fa fa-user fa-fw\"></i> Profile</a>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<a data-toggle=\"modal\" \n\t\t\t\t\t\t\t\tdata-target=\"#settingsmodal\" \n\t\t\t\t\t\t\t\thref=\"#\"><i className=\"fa fa-gear fa-fw\"></i> Settings</a>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t{adminOptions}\n\t\t\t\t\t</ul>\n\t\t\t\t</li>\n\t\t\t);\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n});\n\nvar AssumeUserIdButton = exports.AssumeUserIdButton = React.createClass({\n\tpropTypes: {\n\t\tsocket: React.PropTypes.object.isRequired,\n\t\tgatherer: React.PropTypes.object.isRequired,\n\t\tcurrentUser: React.PropTypes.object.isRequired,\n\t},\n\n\tassumeId(e) {\n\t\te.preventDefault();\n\t\tif (this.props.gatherer) {\n\t\t\tthis.props.socket.emit(\"users:authorize\", {\n\t\t\t\tid: this.props.gatherer.id\n\t\t\t});\n\t\t\t// Refresh Gather list\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.props.socket.emit(\"gather:refresh\");\n\t\t\t}, 5000);\n\t\t}\n\t},\n\n\trender() {\n\t\tlet currentUser = this.props.currentUser;\n\t\tlet gatherer = this.props.gatherer;\n\t\tif (currentUser && gatherer) {\n\t\t\treturn <button\n\t\t\t\tclassName=\"btn btn-xs btn-danger\" \n\t\t\t\tonClick={this.assumeId}>Assume User ID</button>\n\t\t}\n\t}\n});\n","// Accepts an array of IDs voted\n// 1. Creates an array of tally objects, \n//\t\twith ID as prop and vote count as val { 12: 0 }\n// 2. Increments ID vote tally for every vote\n// 3. Sorts \n\nconst rankVotes = exports.rankVotes = function (votes, candidates) {\n\tvar initial = candidates.reduce(function (acc, candidate) {\n\t\tacc[candidate.id] = 0;\n\t\treturn acc;\n\t}, {});\n\n\tvar scores = votes.reduce(function (acc, id) {\n\t\tif (acc[id] !== undefined) {\n\t\t\tacc[id]++;\n\t\t}\n\t\treturn acc;\n\t}, initial);\n\n\tvar rank = [];\n\n\tfor (var id in scores) {\n\t\tif (scores.hasOwnProperty(id)) {\n\t\t\trank.push({\n\t\t\t\tid: parseInt(id, 10),\n\t\t\t\tcount: scores[id]\n\t\t\t});\n\t\t}\n\t}\n\n\treturn rank.sort(function (a, b) {\n\t\tif (b.count === a.count) {\n\t\t\treturn b.id - a.id;\n\t\t} else {\n\t\t\treturn b.count - a.count;\n\t\t}\n\t}).map(function (tally) {\n\t\treturn tally.id\n\t}).map(function (id) {\n\t\treturn candidates.reduce(function (acc, candidate) {\n\t\t\tif (candidate.id === id) return candidate;\n\t\t\treturn acc;\n\t\t});\n\t});\n};\n\nconst enslUrl = exports.enslUrl = (gatherer) => {\n\treturn `http://www.ensl.org/users/${gatherer.id}`\n};\n\nconst hiveUrl = exports.hiveUrl = (gatherer) => {\n\tconst hiveId = gatherer.user.hive.id;\n\tif (hiveId) {\n\t\treturn `http://hive.naturalselection2.com/profile/${hiveId}`;\n\t} else {\n\t\treturn null;\n\t}\n};\n\nconst modalId = exports.modalId = (user) => {\n\treturn `user-modal-${user.id}`;\n};\n\nconst storageAvailable = exports.storageAvailable = (type) => {\n\ttry {\n\t\tvar storage = window[type],\n\t\t\tx = '__storage_test__';\n\t\tstorage.setItem(x, x);\n\t\tstorage.removeItem(x);\n\t\treturn true;\n\t}\n\tcatch(e) {\n\t\treturn false;\n\t}\n};\n"]}